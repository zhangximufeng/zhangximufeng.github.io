(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{274:function(t,s,a){"use strict";a.r(s);var e=a(2),r=Object(e.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("p"),t._m(0),a("p"),t._v(" "),t._m(1),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("nginx是一个开源且高性能、可靠的HTTP中间件和代理服务器")]),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),a("p",[t._v("CENTOS>=7.0,位数 X64 CENTOS 7.2")]),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),a("p",[t._v("iptables命令是Linux上常用的防火墙软件")]),t._v(" "),a("p",[t._v("停止防火墙")]),t._v(" "),t._m(6),a("p",[t._v("永久关闭防火墙")]),t._v(" "),t._m(7),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"http://nginx.org/en/download.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("nginx"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://nginx.org/en/linux_packages.html#stable",target:"_blank",rel:"noopener noreferrer"}},[t._v("linux_packages"),a("OutboundLink")],1)])]),t._v(" "),t._m(20),t._v(" "),a("p",[t._v("/etc/yum.repos.d/nginx.repo")]),t._v(" "),t._m(21),t._m(22),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),a("p",[t._v("查看配置文件和目录")]),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),t._m(29),t._v(" "),t._m(30),t._m(31),t._v(" "),t._m(32),t._m(33),t._v(" "),t._m(34),t._m(35),t._v(" "),t._m(36),t._m(37),t._v(" "),t._m(38),t._m(39),t._v(" "),t._m(40),t._m(41),t._v(" "),t._m(42),t._v(" "),t._m(43),t._v(" "),t._m(44),t._v(" "),t._m(45),t._v(" "),t._m(46),t._v(" "),a("p",[t._v("/etc/nginx/nginx.conf")]),t._v(" "),t._m(47),a("p",[t._v("default.conf")]),t._v(" "),t._m(48),t._m(49),t._v(" "),t._m(50),t._m(51),t._v(" "),t._m(52),t._v(" "),t._m(53),t._v(" "),t._m(54),t._v(" "),t._m(55),t._v(" "),a("p",[t._v("案例")]),t._v(" "),t._m(56),t._m(57),t._v(" "),t._m(58),t._v(" "),t._m(59),t._v(" "),a("p",[a("a",{attrs:{href:"http://nginx.org/en/docs/http/ngx_http_log_module.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ngx_http_log_module"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"http://nginx.org/en/docs/http/ngx_http_log_module.html#log_format",target:"_blank",rel:"noopener noreferrer"}},[t._v("log_format"),a("OutboundLink")],1)]),t._v(" "),t._m(60),t._v(" "),t._m(61),t._v(" "),t._m(62),t._v(" "),t._m(63),t._v(" "),t._m(64),t._v(" "),t._m(65),t._v(" "),t._m(66),t._v(" "),t._m(67),t._v(" "),t._m(68),t._v(" "),t._m(69),t._v(" "),a("p",[t._v("不经过用户内核发送文件")]),t._v(" "),t._m(70),t._v(" "),t._m(71),t._v(" "),a("p",[t._v("在sendfile开启的情况 下，提高网络包的传输效率")]),t._v(" "),t._m(72),t._v(" "),t._m(73),t._v(" "),a("p",[t._v("在keepalive连接下，提高网络包的传输实时性")]),t._v(" "),t._m(74),t._v(" "),t._m(75),t._v(" "),a("p",[t._v("压缩文件可以节约带宽和提高网络传输效率")]),t._v(" "),t._m(76),t._v(" "),t._m(77),t._v(" "),a("p",[t._v("压缩比率越高，文件被压缩的体积越小")]),t._v(" "),t._m(78),t._v(" "),t._m(79),t._v(" "),a("p",[t._v("压缩HTTP版本")]),t._v(" "),t._m(80),t._v(" "),t._m(81),t._v(" "),t._m(82),t._v(" "),t._m(83),t._v(" "),t._m(84),t._m(85),t._v(" "),a("p",[t._v("校验本地缓存是否过期")]),t._v(" "),t._m(86),t._v(" "),t._m(87),t._v(" "),a("p",[t._v("添加Cache-Control、Expires头")]),t._v(" "),t._m(88),t._v(" "),t._m(89),t._m(90),t._v(" "),t._m(91),t._v(" "),t._m(92),t._m(93),t._m(94),t._v(" "),t._m(95),t._v(" "),t._m(96),t._v(" "),t._m(97),t._m(98),t._v(" "),t._m(99),t._v(" "),t._m(100),t._v(" "),t._m(101),t._v(" "),t._m(102),t._v(" "),t._m(103),t._m(104),t._v(" "),t._m(105),t._v(" "),t._m(106),t._m(107),t._v(" "),t._m(108),t._v(" "),t._m(109),t._v(" "),t._m(110),t._v(" "),t._m(111),t._v(" "),t._m(112),t._m(113),t._v(" "),t._m(114),t._v(" "),t._m(115),t._m(116),t._v(" "),t._m(117),t._v(" "),t._m(118),t._v(" "),a("p",[t._v("nginx代理缓存")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/dengjiexian123/article/details/53386586",target:"_blank",rel:"noopener noreferrer"}},[t._v("proxy_cache"),a("OutboundLink")],1)]),t._v(" "),t._m(119),t._m(120)])},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#nginx"}},[t._v("nginx")]),a("ul",[a("li",[a("a",{attrs:{href:"#_2-学习环境"}},[t._v("2\\. 学习环境")])]),a("li",[a("a",{attrs:{href:"#_3-nginx的优势"}},[t._v("3\\. nginx的优势")])]),a("li",[a("a",{attrs:{href:"#_4-nginx安装"}},[t._v("4\\. nginx安装")])]),a("li",[a("a",{attrs:{href:"#_5-目录"}},[t._v("5\\. 目录")])]),a("li",[a("a",{attrs:{href:"#_5-3-编译参数"}},[t._v("5.3 编译参数")])]),a("li",[a("a",{attrs:{href:"#_5-配置文件"}},[t._v("5\\. 配置文件")])]),a("li",[a("a",{attrs:{href:"#_6-启动和重新加载"}},[t._v("6\\. 启动和重新加载")])]),a("li",[a("a",{attrs:{href:"#_7-日志类型"}},[t._v("7\\. 日志类型")])]),a("li",[a("a",{attrs:{href:"#_8-nginx实战"}},[t._v("8\\. nginx实战")])])])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"nginx"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginx","aria-hidden":"true"}},[this._v("#")]),this._v(" nginx")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_2-学习环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-学习环境","aria-hidden":"true"}},[this._v("#")]),this._v(" 2. 学习环境")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_2-1-操作系统"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-操作系统","aria-hidden":"true"}},[this._v("#")]),this._v(" 2.1 操作系统")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_2-2-环境确认"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-环境确认","aria-hidden":"true"}},[this._v("#")]),this._v(" 2.2 环境确认")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_2-2-1-关闭-iptables"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-关闭-iptables","aria-hidden":"true"}},[this._v("#")]),this._v(" 2.2.1 关闭 iptables")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("systemctl stop firewalld.service\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("systemctl disable firewalld.service\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_2-2-2-确认停用-selinux"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-确认停用-selinux","aria-hidden":"true"}},[this._v("#")]),this._v(" 2.2.2 确认停用 selinux")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("p",[this._v("安全增强型 Linux（Security-Enhanced Linux）简称 SELinux，它是一个 Linux 内核模块，也是 Linux 的一个安全子系统。")])]),this._v(" "),s("li",[s("p",[this._v("SELinux 主要作用就是最大限度地减小系统中服务进程可访问的资源（最小权限原则）。")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("功能")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("命令")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("检查状态")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("getenforce")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("检查状态")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("/usr/sbin/sestatus -v")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("临时关闭")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("setenforce 0")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("永久关闭")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("/etc/selinux/config SELINUX=enforcing改SELINUX=disabled")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_2-2-3-安装依赖模块"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3-安装依赖模块","aria-hidden":"true"}},[this._v("#")]),this._v(" 2.2.3 安装依赖模块")])},function(){var t=this.$createElement,s=this._self._c||t;return s("pre",[s("code",[this._v("yum  -y install gcc gcc-c++ autoconf pcre pcre-devel make automake\nyum  -y install wget httpd-tools vim\n")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_3-nginx的优势"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-nginx的优势","aria-hidden":"true"}},[this._v("#")]),this._v(" 3. nginx的优势")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("IO多路复用 多个描述符的IO操作都能在一个线程里并发交替顺序完成，复用线程\n"),a("ul",[a("li",[t._v("select 线性遍历文件描述符列表 1. 效率低下 2.最多只能有1024")]),t._v(" "),a("li",[t._v("epoll 每当fd就绪，采用系统回调函数将fd放入 1.效率高 2.没有1024限制")])])]),t._v(" "),a("li",[t._v("CPU亲和 一种把CPU核心和Nginx工作进程绑定方式，把每个worker进程固定在一个CPU上执行，减少切换CPU和提交缓存命中率,获得更好的性能。")]),t._v(" "),a("li",[t._v("sendfile 零拷贝传输模式 ![usercore]")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"assets/usercore.jpg",alt:"usercore"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_4-nginx安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-nginx安装","aria-hidden":"true"}},[this._v("#")]),this._v(" 4. nginx安装")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_4-1-版本分类"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-版本分类","aria-hidden":"true"}},[this._v("#")]),this._v(" 4.1 版本分类")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("Mainline version 开发版")]),this._v(" "),s("li",[this._v("Stable version 稳定版")]),this._v(" "),s("li",[this._v("Legacy versions 历史版本")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_4-2-下载地址"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-下载地址","aria-hidden":"true"}},[this._v("#")]),this._v(" 4.2 下载地址")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_4-3-centos下yum安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-centos下yum安装","aria-hidden":"true"}},[this._v("#")]),this._v(" 4.3 CentOS下YUM安装")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nname"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nginx repo\nbaseurl"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("packages"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("centos"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$basearch")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("\ngpgcheck"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\nenabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("pre",[s("code",[this._v("yum install nginx -y\nnginx -v\nnginx -V\n")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_5-目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-目录","aria-hidden":"true"}},[this._v("#")]),this._v(" 5. 目录")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_5-1-安装目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-安装目录","aria-hidden":"true"}},[this._v("#")]),this._v(" 5.1 安装目录")])},function(){var t=this.$createElement,s=this._self._c||t;return s("pre",[s("code",[this._v("rpm -ql nginx\n")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_5-2-配置文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-配置文件","aria-hidden":"true"}},[this._v("#")]),this._v(" 5.2 配置文件")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("路径")]),t._v(" "),a("th",[t._v("用途")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("配置文件")]),t._v(" "),a("td",[t._v("/etc/logrotate.d/nginx")]),t._v(" "),a("td",[t._v("用于logrotate服务的日志切割")])]),t._v(" "),a("tr",[a("td",[t._v("配置文件")]),t._v(" "),a("td",[t._v("/etc/nginx /etc/nginx/nginx.conf /etc/nginx/conf.d /etc/nginx/conf.d/default.conf")]),t._v(" "),a("td",[t._v("主配置文件")])]),t._v(" "),a("tr",[a("td",[t._v("配置文件")]),t._v(" "),a("td",[t._v("/etc/nginx/fastcgi_params /etc/nginx/scgi_params /etc/nginx/uwsgi_params")]),t._v(" "),a("td",[t._v("cgi配置,fastcgi配置")])]),t._v(" "),a("tr",[a("td",[t._v("配置文件")]),t._v(" "),a("td",[t._v("/etc/nginx/koi-utf /etc/nginx/koi-win /etc/nginx/win-utf")]),t._v(" "),a("td",[t._v("编码转换映射转化文件")])]),t._v(" "),a("tr",[a("td",[t._v("配置文件")]),t._v(" "),a("td",[t._v("/etc/nginx/mime.types")]),t._v(" "),a("td",[t._v("设置http协议的Content-Type与扩展名对应关系")])]),t._v(" "),a("tr",[a("td",[t._v("配置文件")]),t._v(" "),a("td",[t._v("/usr/lib/systemd/system/nginx-debug.service /usr/lib/systemd/system/nginx.service /etc/sysconfig/nginx /etc/sysconfig/nginx-debug")]),t._v(" "),a("td",[t._v("用于配置系统守护进程管理器管理方式")])]),t._v(" "),a("tr",[a("td",[t._v("配置文件")]),t._v(" "),a("td",[t._v("/etc/nginx/modules /usr/lib64/nginx/modules")]),t._v(" "),a("td",[t._v("nginx模块目录")])]),t._v(" "),a("tr",[a("td",[t._v("命令")]),t._v(" "),a("td",[t._v("/usr/share/doc/nginx-1.14.0 /usr/share/doc/nginx-1.14.0/COPYRIGHT")]),t._v(" "),a("td",[t._v("nginx的手册和帮助文件")])]),t._v(" "),a("tr",[a("td",[t._v("目录")]),t._v(" "),a("td",[t._v("/var/cache/nginx")]),t._v(" "),a("td",[t._v("nginx的缓存目录")])]),t._v(" "),a("tr",[a("td",[t._v("目录")]),t._v(" "),a("td",[t._v("/var/log/nginx")]),t._v(" "),a("td",[t._v("nginx的日志目录")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_5-3-编译参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-编译参数","aria-hidden":"true"}},[this._v("#")]),this._v(" 5.3 编译参数")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_5-3-1-安装目录和路径"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-1-安装目录和路径","aria-hidden":"true"}},[this._v("#")]),this._v(" 5.3.1 安装目录和路径")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("prefix"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("modules"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("lib64"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("modules\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("conf"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("conf\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("access"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pid")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("run"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pid")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("lock"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("run"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lock\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_5-3-2-执行对应模块时，nginx所保留的临时性文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-2-执行对应模块时，nginx所保留的临时性文件","aria-hidden":"true"}},[this._v("#")]),this._v(" 5.3.2 执行对应模块时，nginx所保留的临时性文件")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("client"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("temp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("cache"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("client_temp\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("temp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("cache"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("proxy_temp\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("fastcgi"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("temp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("cache"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("fastcgi_temp\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("uwsgi"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("temp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("cache"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("uwsgi_temp\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("scgi")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("temp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("cache"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("scgi_temp\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_5-3-3-设置nginx进程启动的用户和用户组"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-3-设置nginx进程启动的用户和用户组","aria-hidden":"true"}},[this._v("#")]),this._v(" 5.3.3 设置nginx进程启动的用户和用户组")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nginx\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("group"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nginx\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_5-3-4-设置额外的参数将被添加到cflags变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-4-设置额外的参数将被添加到cflags变量","aria-hidden":"true"}},[this._v("#")]),this._v(" 5.3.4 设置额外的参数将被添加到CFLAGS变量")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("opt"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("'"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("O2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("g "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("pipe "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Wall "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Wp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("D_FORTIFY_SOURCE"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("fexceptions "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("fstack"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("protector"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("strong\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_5-3-5-设置附加的参数，链接系统库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-5-设置附加的参数，链接系统库","aria-hidden":"true"}},[this._v("#")]),this._v(" 5.3.5 设置附加的参数，链接系统库")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ld"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("opt"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-Wl,-z,relro -Wl,-z,now -pie'")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_5-3-6-其它参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-6-其它参数","aria-hidden":"true"}},[this._v("#")]),this._v(" 5.3.6 其它参数")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("compat\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("file"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("aio")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("threads\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http_addition_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http_auth_request_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http_dav_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http_flv_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http_gunzip_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http_gzip_static_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http_mp4_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http_random_index_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http_realip_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http_secure_link_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http_slice_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http_ssl_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http_stub_status_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http_sub_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("http_v2_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("mail\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("mail_ssl_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("stream\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("stream_realip_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("stream_ssl_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("with"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("stream_ssl_preread_module\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("param"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ssp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("buffer"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("size"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("grecord"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("gcc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("switches "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("m64 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("mtune"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("generic "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("fPIC'\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_5-配置文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-配置文件","aria-hidden":"true"}},[this._v("#")]),this._v(" 5. 配置文件")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("/etc/nginx/nginx.conf")]),this._v(" "),s("li",[this._v("/etc/nginx/conf.d/*.conf /etc/nginx/conf.d/default.conf")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_5-1-全局和服务配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-全局和服务配置","aria-hidden":"true"}},[this._v("#")]),this._v(" 5.1 全局和服务配置")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("分类")]),t._v(" "),a("th",[t._v("配置项")]),t._v(" "),a("th",[t._v("作用")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("全局")]),t._v(" "),a("td",[t._v("user")]),t._v(" "),a("td",[t._v("设置nginx服务的系统使用用户")])]),t._v(" "),a("tr",[a("td",[t._v("全局")]),t._v(" "),a("td",[t._v("worker_processes")]),t._v(" "),a("td",[t._v("工作进程数,一般和CPU数量相同")])]),t._v(" "),a("tr",[a("td",[t._v("全局")]),t._v(" "),a("td",[t._v("error_log")]),t._v(" "),a("td",[t._v("nginx的错误日志")])]),t._v(" "),a("tr",[a("td",[t._v("全局")]),t._v(" "),a("td",[t._v("pid")]),t._v(" "),a("td",[t._v("nginx服务启动时的pid")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_5-2-全局和服务配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-全局和服务配置","aria-hidden":"true"}},[this._v("#")]),this._v(" 5.2 全局和服务配置")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("分类")]),t._v(" "),a("th",[t._v("配置项")]),t._v(" "),a("th",[t._v("作用")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("events")]),t._v(" "),a("td",[t._v("worker_connections")]),t._v(" "),a("td",[t._v("每个进程允许的最大连接数 10000")])]),t._v(" "),a("tr",[a("td",[t._v("events")]),t._v(" "),a("td",[t._v("use")]),t._v(" "),a("td",[t._v("指定使用哪种模型（select/poll/epoll）,建议让nginx自动选择,linux内核2.6以上一般能使用epoll，提高性能。")])])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),t._v("  nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   设置nginx服务的系统使用用户\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("worker_processes")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  工作进程数"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("一般和CPU数量相同\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("error_log")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log warn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   nginx的错误日志\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pid")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("run"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pid")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   nginx服务启动时的"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pid")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("events")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("worker_connections")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("每个进程允许的最大连接数 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10000")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("include")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("types")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("文件后缀和类型类型的对应关系\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default_type")]),t._v("  application"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("octet"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("stream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("默认content"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("type\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("log_format")]),t._v("  main  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$remote_addr - $remote_user [$time_local] \"$request\" '")]),t._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$status $body_bytes_sent \"$http_referer\" '")]),t._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'"$http_user_agent" "$http_x_forwarded_for"\'')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("日志记录格式\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("access_log")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("access"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log  main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("默认访问日志\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sendfile")]),t._v("        on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("启用"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sendfile")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#tcp_nopush     on;//懒发送")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("keepalive_timeout")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("65")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("超时时间是"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("65")]),t._v("秒\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#gzip  on;gzip压缩")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("include")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("d"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("包含的子配置文件\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("监听的端口号\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("  localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("用域名方式访问的地址\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#charset koi8-r; //编码")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#access_log  /var/log/nginx/host.access.log  main;  //访问日志文件和名称")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("share"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("静态文件根目录\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("htm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("首页的索引文件\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#error_page  404              /404.html;  //指定错误页面")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# redirect server error pages to the static page /50x.html")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 把后台错误重定向到静态的50x.html页面")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("error_page")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("502")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("503")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("504")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("share"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# proxy the PHP scripts to Apache listening on 127.0.0.1:80")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 代理PHP脚本到80端口上的apache服务器")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#location ~ \\.php$ {")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#    proxy_pass   http://127.0.0.1;")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 把PHP脚本9000端口上监听的FastCGI服务")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#location ~ \\.php$ {")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#    root           html;")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#    fastcgi_pass   127.0.0.1:9000;")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#    fastcgi_index  index.php;")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#    include        fastcgi_params;")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# deny access to .htaccess files, if Apache's document root")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# concurs with nginx's one")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 不允许访问.htaccess文件")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#location ~ /\\.ht {")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#    deny  all;")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_6-启动和重新加载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-启动和重新加载","aria-hidden":"true"}},[this._v("#")]),this._v(" 6. 启动和重新加载")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[this._v("systemctl restart nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v(".")]),this._v("service\nsystemctl reload nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v(".")]),this._v("service\nnginx "),s("span",{pre:!0,attrs:{class:"token operator"}},[this._v("-")]),this._v("s reload\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_7-日志类型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-日志类型","aria-hidden":"true"}},[this._v("#")]),this._v(" 7. 日志类型")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_7-1-日志类型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-日志类型","aria-hidden":"true"}},[this._v("#")]),this._v(" 7.1 日志类型")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("access_.log 访问日志")]),this._v(" "),s("li",[this._v("error.log 错误日志")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_7-2-log-format"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-log-format","aria-hidden":"true"}},[this._v("#")]),this._v(" 7.2 log_format")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("用法")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("语法")]),t._v(" "),a("td",[t._v("log_format name [escape=default[json] string]")])]),t._v(" "),a("tr",[a("td",[t._v("默认")]),t._v(" "),a("td",[t._v("log_format combined ...")])]),t._v(" "),a("tr",[a("td",[t._v("Context")]),t._v(" "),a("td",[t._v("http")])])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("log_format")]),t._v("  main  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$remote_addr - $remote_user [$time_local] \"$request\" '")]),t._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$status $body_bytes_sent \"$http_referer\" '")]),t._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'"$http_user_agent" "$http_x_forwarded_for"\'')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("log_format")]),t._v("  zxmf  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$arg_name $http_referer sent_http_date\"'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("access_log")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("access"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log  main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("221.216")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".143")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".110")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("09")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Jun"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2018")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("41")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0800")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GET / HTTP/1.1"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("612")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-"')]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_7-3-http请求变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-http请求变量","aria-hidden":"true"}},[this._v("#")]),this._v(" 7.3 HTTP请求变量")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("名称")]),t._v(" "),a("th",[t._v("含义")]),t._v(" "),a("th",[t._v("例子")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("arg_PARAMETER")]),t._v(" "),a("td",[t._v("请求参数")]),t._v(" "),a("td",[t._v("$arg_name")])]),t._v(" "),a("tr",[a("td",[t._v("http_HEADER")]),t._v(" "),a("td",[t._v("请求头")]),t._v(" "),a("td",[t._v("$http_referer")])]),t._v(" "),a("tr",[a("td",[t._v("sent_http_HEADER")]),t._v(" "),a("td",[t._v("响应头")]),t._v(" "),a("td",[t._v("sent_http_cookie")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_7-4-内置变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-4-内置变量","aria-hidden":"true"}},[this._v("#")]),this._v(" 7.4 内置变量")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("名称")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("$remote_addr")]),t._v(" "),a("td",[t._v("客户端地址")])]),t._v(" "),a("tr",[a("td",[t._v("$remote_user")]),t._v(" "),a("td",[t._v("客户端用户名称")])]),t._v(" "),a("tr",[a("td",[t._v("$time_local")]),t._v(" "),a("td",[t._v("访问时间和时区")])]),t._v(" "),a("tr",[a("td",[t._v("$request")]),t._v(" "),a("td",[t._v("请求的URI和HTTP协议")])]),t._v(" "),a("tr",[a("td",[t._v("$http_host")]),t._v(" "),a("td",[t._v("请求地址，即浏览器中你输入的地址（IP或域名）")])]),t._v(" "),a("tr",[a("td",[t._v("$status")]),t._v(" "),a("td",[t._v("HTTP请求状态")])]),t._v(" "),a("tr",[a("td",[t._v("$body_bytes_sent")]),t._v(" "),a("td",[t._v("发送给客户端文件内容大小")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_8-nginx实战"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-nginx实战","aria-hidden":"true"}},[this._v("#")]),this._v(" 8. nginx实战")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_8-1-静态资源web服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-静态资源web服务","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.1 静态资源Web服务")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("静态资源：一般客户端发送请求到web服务器，web服务器从内存在取到相应的文件，返回给客户端，客户端解析并渲染显示出来。")]),this._v(" "),s("li",[this._v("动态资源：一般客户端请求的动态资源，先将请求交于web容器，web容器连接数据库，数据库处理数据之后，将内容交给web服务器，web服务器返回给客户端解析渲染处理。")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("种类")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("浏览器渲染")]),t._v(" "),a("td",[t._v("HTML、CSS、JS")])]),t._v(" "),a("tr",[a("td",[t._v("图片")]),t._v(" "),a("td",[t._v("JPEG、GIF、PNG")])]),t._v(" "),a("tr",[a("td",[t._v("视频")]),t._v(" "),a("td",[t._v("FLV、MPEG")])]),t._v(" "),a("tr",[a("td",[t._v("下载文件")]),t._v(" "),a("td",[t._v("Word、Excel")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_8-2-cdn"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-cdn","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.2 CDN")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("CDN的全称是Content Delivery Network，即内容分发网络。")]),this._v(" "),s("li",[this._v("CDN系统能够实时地根据网络流量和各节点的连接、负载状况以及到用户的距离和响应时间等综合信息将用户的请求重新导向离用户最近的服务节点上。其目的是使用户可就近取得所需内容，解决 Internet网络拥挤的状况，提高用户访问网站的响应速度。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"assets/cdn.jpg",alt:"cdn"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_8-2-1-配置语法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-1-配置语法","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.2.1 配置语法")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"_8-2-1-1-sendfile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-1-1-sendfile","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.2.1.1 sendfile")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("种类")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("语法")]),t._v(" "),a("td",[t._v("sendfile on / off")])]),t._v(" "),a("tr",[a("td",[t._v("默认")]),t._v(" "),a("td",[t._v("sendfile off;")])]),t._v(" "),a("tr",[a("td",[t._v("上下文")]),t._v(" "),a("td",[t._v("http,server,location,if in location")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"_8-2-1-2-tcp-nopush"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-1-2-tcp-nopush","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.2.1.2 tcp_nopush")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("种类")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("语法")]),t._v(" "),a("td",[t._v("tcp_nopush on / off")])]),t._v(" "),a("tr",[a("td",[t._v("默认")]),t._v(" "),a("td",[t._v("tcp_nopush off;")])]),t._v(" "),a("tr",[a("td",[t._v("上下文")]),t._v(" "),a("td",[t._v("http,server,location")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"_8-2-1-2-tcp-nodelay"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-1-2-tcp-nodelay","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.2.1.2 tcp_nodelay")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("种类")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("语法")]),t._v(" "),a("td",[t._v("tcp_nodelay on / off")])]),t._v(" "),a("tr",[a("td",[t._v("默认")]),t._v(" "),a("td",[t._v("tcp_nodelay on;")])]),t._v(" "),a("tr",[a("td",[t._v("上下文")]),t._v(" "),a("td",[t._v("http,server,location")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"_8-2-1-3-gzip"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-1-3-gzip","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.2.1.3 gzip")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("种类")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("语法")]),t._v(" "),a("td",[t._v("gzip on / off")])]),t._v(" "),a("tr",[a("td",[t._v("默认")]),t._v(" "),a("td",[t._v("gzip off;")])]),t._v(" "),a("tr",[a("td",[t._v("上下文")]),t._v(" "),a("td",[t._v("http,server,location")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"_8-2-1-4-gzip-comp-level"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-1-4-gzip-comp-level","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.2.1.4 gzip_comp_level")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("种类")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("语法")]),t._v(" "),a("td",[t._v("gzip_comp_level level")])]),t._v(" "),a("tr",[a("td",[t._v("默认")]),t._v(" "),a("td",[t._v("gzip_comp_level 1;")])]),t._v(" "),a("tr",[a("td",[t._v("上下文")]),t._v(" "),a("td",[t._v("http,server,location")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"_8-2-1-5-gzip-http-version"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-1-5-gzip-http-version","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.2.1.5 gzip_http_version")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("种类")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("语法")]),t._v(" "),a("td",[t._v("gzip_http_version 1.0/1.1")])]),t._v(" "),a("tr",[a("td",[t._v("默认")]),t._v(" "),a("td",[t._v("gzip_http_version 1.1;")])]),t._v(" "),a("tr",[a("td",[t._v("上下文")]),t._v(" "),a("td",[t._v("http,server,location")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"_8-2-1-6-http-gzip-static-module"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-1-6-http-gzip-static-module","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.2.1.6 http_gzip-static_module")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("先找磁盘上找同名的"),s("code",[this._v(".gz")]),this._v("这个文件是否存在,节约CPU的压缩时间和性能损耗")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("种类")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("语法")]),t._v(" "),a("td",[t._v("gzip_static on/off")])]),t._v(" "),a("tr",[a("td",[t._v("默认")]),t._v(" "),a("td",[t._v("gzip_static off;")])]),t._v(" "),a("tr",[a("td",[t._v("上下文")]),t._v(" "),a("td",[t._v("http,server,location")])])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jpg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("png"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("gif"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip")]),t._v(" off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_http_version")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_comp_level")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_types")]),t._v(" image"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("jpeg image"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("png image"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("gif"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("images"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("js"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("css"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip")]),t._v(" on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_min_length")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_http_version")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_comp_level")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_types")]),t._v("  text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("css application"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("javascript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("download "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_static")]),t._v(" on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("tcp_nopush")]),t._v(" on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("download"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_8-3-浏览器缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-3-浏览器缓存","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.3 浏览器缓存")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("种类")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("检验是否过期")]),t._v(" "),a("td",[t._v("Expires、Cache-Control(max-age)")])]),t._v(" "),a("tr",[a("td",[t._v("Etag")]),t._v(" "),a("td",[t._v("Etag")])]),t._v(" "),a("tr",[a("td",[t._v("Last-Modified")]),t._v(" "),a("td",[t._v("Last-Modified")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_8-3-1-expires"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-3-1-expires","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.3.1 expires")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("种类")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("语法")]),t._v(" "),a("td",[t._v("expires time")])]),t._v(" "),a("tr",[a("td",[t._v("默认")]),t._v(" "),a("td",[t._v("expires off;")])]),t._v(" "),a("tr",[a("td",[t._v("上下文")]),t._v(" "),a("td",[t._v("http,server,location")])])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jpg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("png"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("gif"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("expires")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_8-4-跨域"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-4-跨域","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.4 跨域")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("种类")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("语法")]),t._v(" "),a("td",[t._v("add_header name value")])]),t._v(" "),a("tr",[a("td",[t._v("默认")]),t._v(" "),a("td",[t._v("add_header --;")])]),t._v(" "),a("tr",[a("td",[t._v("上下文")]),t._v(" "),a("td",[t._v("http,server,location")])])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("json$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" Access"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Control"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Allow")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Origin "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" Access"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Control"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Allow")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Methods GET"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("POST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("PUT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("DELETE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("OPTIONS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("json"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" xhr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'GET'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://47.104.184.134/users.json'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onreadystatechange")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nxhr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_8-5-防盗链"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-5-防盗链","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.5 防盗链")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("防止网站资源被盗用")]),t._v(" "),a("li",[t._v("保证信息安全")]),t._v(" "),a("li",[t._v("防止流量过量")]),t._v(" "),a("li",[t._v("区别哪些请求是非正常的用户请求")]),t._v(" "),a("li",[t._v("使用http_refer防盗链")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("种类")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("语法")]),t._v(" "),a("td",[t._v("valid_referers none block server_names string...")])]),t._v(" "),a("tr",[a("td",[t._v("默认")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("上下文")]),t._v(" "),a("td",[t._v("server,location")])])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jpg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("png"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("gif"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("expires")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip")]),t._v(" off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_http_version")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_comp_level")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_types")]),t._v(" image"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("jpeg image"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("png image"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("gif"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("valid_referers")]),t._v(" none blocked "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("47.104")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".184")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".134")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$invalid_referer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n           "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("images"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_8-6-代理服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-6-代理服务","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.6 代理服务")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_8-6-1-配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-6-1-配置","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.6.1 配置")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("种类")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("语法")]),t._v(" "),a("td",[t._v("proxy_pass URL")])]),t._v(" "),a("tr",[a("td",[t._v("默认")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("上下文")]),t._v(" "),a("td",[t._v("server,location")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_8-6-2-反向代理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-6-2-反向代理","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.6.2 反向代理")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("反向代理的对象的服务端 "),s("img",{attrs:{src:"assets/fanproxy.jpg",alt:"fanproxy"}})])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("resolver")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.8")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".8")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("api "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_8-6-3-正向代理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-6-3-正向代理","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.6.3 正向代理")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("正向代理的对象是客户端 "),s("img",{attrs:{src:"assets/positiveproxy.jpg",alt:"positiveproxy"}})])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request_uri")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_8-7-负载均衡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-7-负载均衡","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.7 负载均衡")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"assets/nginxbalance.jpg",alt:"nginxbalance"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("使用集群是网站解决高并发、海量数据问题的常用手段。")]),this._v(" "),s("li",[this._v("当一台服务器的处理能力、存储空间不足时，不要企图去换更强大的服务器，对大型网站而言，不管多么强大的服务器，都满足不了网站持续增长的业务需求。")]),this._v(" "),s("li",[this._v("这种情况下，更恰当的做法是增加一台服务器分担原有服务器的访问及存储压力。通过负载均衡调度服务器，将来自浏览器的访问请求分发到应用服务器集群中的任何一台服务器上，如果有更多的用户，就在集群中加入更多的应用服务器，使应用服务器的负载压力不再成为整个网站的瓶颈。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_8-7-1-upstream"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-7-1-upstream","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.7.1 upstream")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("种类")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("语法")]),t._v(" "),a("td",[t._v("upstream name {}")])]),t._v(" "),a("tr",[a("td",[t._v("默认")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("上下文")]),t._v(" "),a("td",[t._v("http")])])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("upstream")]),t._v(" zxmf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ip_hash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("zxmf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_8-7-2-后端服务器调试状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-7-2-后端服务器调试状态","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.7.2 后端服务器调试状态")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("状态")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("down")]),t._v(" "),a("td",[t._v("不参与负载均衡")])]),t._v(" "),a("tr",[a("td",[t._v("backup")]),t._v(" "),a("td",[t._v("备份的服务器")])]),t._v(" "),a("tr",[a("td",[t._v("max_fails")]),t._v(" "),a("td",[t._v("允许请求失败的次数")])]),t._v(" "),a("tr",[a("td",[t._v("fail_timeout")]),t._v(" "),a("td",[t._v("经过max_fails失败后，服务暂停的时间")])]),t._v(" "),a("tr",[a("td",[t._v("max_conns")]),t._v(" "),a("td",[t._v("限制最大的接收的连接数")])])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("upstream")]),t._v(" zxmf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),t._v(" down"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4000")]),t._v(" backup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5000")]),t._v(" max_fails"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" fail_timeout"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_8-7-3-分配方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-7-3-分配方式","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.7.3 分配方式")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("种类")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("轮询（默认）")]),t._v(" "),a("td",[t._v("每个请求按时间顺序逐一分配到不同的后端服务器，如果后端服务器down掉，能自动剔除。")])]),t._v(" "),a("tr",[a("td",[t._v("weight(加权轮询)")]),t._v(" "),a("td",[t._v("指定轮询几率，weight和访问比率成正比，用于后端服务器性能不均的情况。")])]),t._v(" "),a("tr",[a("td",[t._v("ip_hash")]),t._v(" "),a("td",[t._v("每个请求按访问ip的hash结果分配，这样每个访客固定访问一个后端服务器，可以解决session的问题。")])]),t._v(" "),a("tr",[a("td",[t._v("url_hash（第三方）")]),t._v(" "),a("td",[t._v("按访问的URL地址来分配 请求，每个URL都定向到同一个后端 服务器上(缓存)")])]),t._v(" "),a("tr",[a("td",[t._v("fair（第三方）")]),t._v(" "),a("td",[t._v("按后端服务器的响应时间来分配请求，响应时间短的优先分配。")])]),t._v(" "),a("tr",[a("td",[t._v("least_conn")]),t._v(" "),a("td",[t._v("最小连接数，哪个连接少就分给谁")])]),t._v(" "),a("tr",[a("td",[t._v("自定义hash")]),t._v(" "),a("td",[t._v("hash自定义key")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_8-8-缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-8-缓存","aria-hidden":"true"}},[this._v("#")]),this._v(" 8.8 缓存")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_cache_path")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tmp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("test levels"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" keys_zone"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("tmp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("m inactive"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("d max_size"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("g"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[a("p",[t._v("proxy_cache_path 缓存文件路径")])]),t._v(" "),a("li",[a("p",[t._v("levels 设置缓存文件目录层次；levels=1:2 表示两级目录")])]),t._v(" "),a("li",[a("p",[t._v("keys_zone 设置缓存名字和共享内存大小")])]),t._v(" "),a("li",[a("p",[t._v("inactive 在指定时间内没人访问则被删除")])]),t._v(" "),a("li",[a("p",[t._v("max_size 最大缓存空间，如果缓存空间满，默认覆盖掉缓存时间最长的资源。")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tmp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("test"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_cache")]),t._v(" tmp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_cache_valid")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("206")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("304")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("301")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("302")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_cache_key")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" Host "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$server_port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Real"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("IP "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v("   X"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Forwarded"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("For "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8081")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("media_store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tmp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("test"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("proxy_cache tmp-test 使用名为tmp-test的对应缓存配置")])]),t._v(" "),a("li",[a("p",[t._v("proxy_cache_valid 200 206 304 301 302 10d; 对httpcode为200…的缓存10天")])]),t._v(" "),a("li",[a("p",[t._v("proxy_cache_key $uri 定义缓存唯一key,通过唯一key来进行hash存取")])]),t._v(" "),a("li",[a("p",[t._v("proxy_set_header 自定义http header头，用于发送给后端真实服务器。")])]),t._v(" "),a("li",[a("p",[t._v("proxy_pass 指代理后转发的路径，注意是否需要最后的/")])])])}],!1,null,null,null);s.default=r.exports}}]);