(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{340:function(t,s,e){"use strict";e.r(s);var a=e(2),n=Object(a.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[e("p"),t._m(0),e("p"),t._v(" "),t._m(1),t._v(" "),e("hr"),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),e("p",[t._v("HTTPS是在通信接口部分用 TLS(Transport Layer Security)协议。")]),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),e("p",[t._v("HTTPS 协议的主要功能基本都依赖于 TLS/SSL 协议，TLS/SSL 的功能实现主要依赖于三类基本算法：散列函数 、对称加密和非对称加密，其利用非对称加密实现身份认证和密钥协商，对称加密算法采用协商的密钥对数据加密，基于散列函数验证信息的完整性。")]),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),e("p",[t._v("结合三类算法的特点，TLS 的基本工作方式是")]),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),t._m(29),t._v(" "),t._m(30),t._v(" "),e("p",[t._v("对称加密算法的特点是加密和解密是使用同一个密钥，加解密速度快，典型的对称加密算法有DES、AES等。使用对称加密，客户端和服务端双方拥有相同的密钥，信息得到安全传输。 此种方式的缺点是：")]),t._v(" "),t._m(31),t._v(" "),t._m(32),t._v(" "),e("p",[t._v("非对称加密算法的特点加密和解密分别使用不同的密钥, 相对来说加解密速度较慢，典型的非对称加密算法有RSA、DSA等。客户端用公钥对请求内容加密，服务器使用私钥对内容解密，反之亦然。 此种方式的缺点是：")]),t._v(" "),t._m(33),t._v(" "),e("p",[t._v("客户端C和服务器S进行通信，中间节点M截获了二者的通信； 节点M自己计算产生一对公钥pub_M和私钥 pri_M； C向S请求公钥时，M把自己的公钥pub_M发给了C； C 使用公钥pub_M加密的数据能够被M解密，因为M掌握对应的私钥 pri_M，而 C 无法根据公钥信息判断服务器的身份，从而 C 和 M 之间建立了“可信”加密连接; 中间节点 M 和服务器S之间再建立合法的连接，因此 C 和 S 之间通信被M完全掌握，M 可以进行信息的窃听、篡改等操作。")]),t._v(" "),t._m(34),t._v(" "),t._m(35),t._v(" "),e("p",[t._v("客户端发起请求，以明文传输请求信息，包含版本信息，加密套件候选列表，压缩算法候选列表，随机数，扩展字段等信息，相关信息如下：")]),t._v(" "),t._m(36),t._v(" "),t._m(37),t._v(" "),t._m(38),t._v(" "),t._m(39),t._v(" "),t._m(40),t._v(" "),e("p",[t._v("a. 客户端验证服务端证书的合法性，如果验证通过才会进行后续通信，否则根据错误情况不同做出提示和操作，合法性验证包括如下：")]),t._v(" "),t._m(41),t._v(" "),t._m(42),t._v(" "),e("p",[t._v("a. Client发送ChangeCipherSpec，指示Server从现在开始发送的消息都是加密过的 b. Client发送Finishd，包含了前面所有握手消息的hash，可以让server验证握手过程是否被第三方篡改 c. 服务端发送ChangeCipherSpec，指示Client从现在开始发送的消息都是加密过的 d. Server发送Finishd，包含了前面所有握手消息的hash，可以让client验证握手过程是否被第三方篡改，并且证明自己是Certificate密钥的拥有者，即证明自己的身份")]),t._v(" "),t._m(43),t._v(" "),t._m(44),t._v(" "),t._m(45),t._v(" "),t._m(46),t._v(" "),e("p",[t._v("证书的作用就是,我和服务端通信,我怎么知道这个服务端是我要真正通信的服务端呢")]),t._v(" "),t._m(47),t._v(" "),t._m(48),t._v(" "),t._m(49),t._v(" "),t._m(50),t._v(" "),t._m(51),t._v(" "),t._m(52),t._v(" "),t._m(53),t._v(" "),t._m(54),t._v(" "),t._m(55),t._v(" "),t._m(56),t._v(" "),t._m(57),t._m(58),t._v(" "),t._m(59),t._m(60),t._v(" "),t._m(61),t._m(62),t._v(" "),t._m(63),t._m(64),t._v(" "),e("p",[t._v("创建HTTPS服务器同HTTP服务器大致相同，需要增加证书，创建HTTPS服务器时通过options参数设置。")]),t._v(" "),t._m(65),t._m(66),t._v(" "),e("p",[t._v("opts参数为一个对象，用于指定创建HTTPS服务器时配置的各种选项，下面只描述几个必要选项：")]),t._v(" "),t._m(67),t._v(" "),t._m(68),t._v(" "),e("p",[t._v("在https模块中，可以使用request方法向其它使用HTTPS协议的网站请求数据")]),t._v(" "),t._m(69),t._m(70),t._v(" "),t._m(71),t._v(" "),e("ul",[e("li",[e("p",[e("a",{attrs:{href:"http://www.laozuo.org/7676.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("实战申请Let's Encrypt永久免费SSL证书过程教程及常见问题"),e("OutboundLink")],1)]),t._v(" "),t._m(72)])]),t._v(" "),t._m(73)])},[function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#http通信有什么问题"}},[t._v("http通信有什么问题?")]),e("ul",[e("li",[e("a",{attrs:{href:"#_2-https如何解决上述三个问题-t42-https如何解决上述三个问题"}},[t._v("2\\. HTTPS如何解决上述三个问题? #")])]),e("li",[e("a",{attrs:{href:"#_3-ssl-和-tls-的区别-t53-ssl-和-tls-的区别"}},[t._v("3\\. SSL 和 TLS 的区别 #")])]),e("li",[e("a",{attrs:{href:"#_3-ssl-协议-t63-ssl-协议"}},[t._v("3\\. SSL 协议 #")])]),e("li",[e("a",{attrs:{href:"#_3-6-https协议改进过程-t123-6-https协议改进过程"}},[t._v("3.6 HTTPS协议改进过程 #")])]),e("li",[e("a",{attrs:{href:"#_3-6-2-安全传递密钥-t143-6-2-安全传递密钥"}},[t._v("3.6.2 安全传递密钥 #")])]),e("li",[e("a",{attrs:{href:"#_3-7-证书-t213-7-证书"}},[t._v("3.7 证书 #")])]),e("li",[e("a",{attrs:{href:"#_2-https服务器-t242-https服务器"}},[t._v("2\\. https服务器 #")])]),e("li",[e("a",{attrs:{href:"#_3-8-让你的网站支持https-t313-8-让你的网站支持https"}},[t._v("3.8 让你的网站支持https #")])])])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"http通信有什么问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http通信有什么问题","aria-hidden":"true"}},[this._v("#")]),this._v(" http通信有什么问题?")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[t._v("窃听 - 对称加密")]),t._v(" "),e("li",[t._v("传递密钥 - 非对称加密")]),t._v(" "),e("li",[t._v("安全速度 - 非对称加密+对称加密")]),t._v(" "),e("li",[t._v("中间人攻击 - 证书")]),t._v(" "),e("li",[t._v("证书伪造 - 消息摘要")]),t._v(" "),e("li",[t._v("摘要伪造 - 数字签名")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_1-1-可能被窃听-t11-1-可能被窃听"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-可能被窃听-t11-1-可能被窃听","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.1 可能被窃听 [#](#t11.1 可能被窃听)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("HTTP 本身不具备加密的功能,HTTP 报文使用明文方式发送")]),this._v(" "),s("li",[this._v("由于互联网是由联通世界各个地方的网络设施组成,所有发送和接收经过某些设备的数据都可能被截获或窥视。(例如大家都熟悉的抓包工具:Wireshark),即使经过加密处理,也会被窥视是通信内容,只是可能很难或者无法破解出报文的信息而已")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_1-2-认证问题-t21-2-认证问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-认证问题-t21-2-认证问题","aria-hidden":"true"}},[this._v("#")]),this._v(" 1.2 认证问题 [#](#t21.2 认证问题)")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[e("p",[t._v("无法确认你发送到的服务器就是真正的目标服务器(可能服务器是伪装的)")])]),t._v(" "),e("li",[e("p",[t._v("无法确定返回的客户端是否是按照真实意图接收的客户端(可能是伪装的客户端)")])]),t._v(" "),e("li",[e("p",[t._v("无法确定正在通信的对方是否具备访问权限,Web 服务器上某些重要的信息，只想发给特定用户即使是无意义的请求也会照单全收。无法阻止海量请求下的 DoS 攻击（Denial of Service，拒绝服务攻击）。")]),t._v(" "),e("h3",{attrs:{id:"_1-3-可能被篡改-t31-3-可能被篡改"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-可能被篡改-t31-3-可能被篡改","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.3 可能被篡改 [#](#t31.3 可能被篡改)")]),t._v(" "),e("p",[t._v("请求或响应在传输途中，遭攻击者拦截并篡改内容的攻击被称为中间人攻击（Man-in-the-Middle attack，MITM）。")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_2-https如何解决上述三个问题-t42-https如何解决上述三个问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-https如何解决上述三个问题-t42-https如何解决上述三个问题","aria-hidden":"true"}},[this._v("#")]),this._v(" 2. HTTPS如何解决上述三个问题? [#](#t42. HTTPS如何解决上述三个问题?)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"http://img.zhufengpeixun.cn/https1.png",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_3-ssl-和-tls-的区别-t53-ssl-和-tls-的区别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-ssl-和-tls-的区别-t53-ssl-和-tls-的区别","aria-hidden":"true"}},[this._v("#")]),this._v(" 3. SSL 和 TLS 的区别 [#](#t53. SSL 和 TLS 的区别)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("传输层安全性协议（英语：Transport Layer Security，缩写作 TLS），及其前身安全套接层（Secure Sockets Layer，缩写作 SSL）是一种安全协议，目的是为互联网通信，提供安全及数据完整性保障。")]),this._v(" "),s("li",[this._v("网景公司（Netscape）在1994年推出首版网页浏览器，网景导航者时，推出HTTPS协议，以SSL进行加密，这是SSL的起源。")]),this._v(" "),s("li",[this._v("IETF将SSL进行标准化，1999年公布第一版TLS标准文件。随后又公布RFC 5246 （2008年8月）与 RFC 6176 （2011年3月）。以下就简称SSL")]),this._v(" "),s("li",[this._v("TLS是SSL的标准. HTTPS 就是 HTTP + SSL")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"http://img.zhufengpeixun.cn/https_http.png",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_3-ssl-协议-t63-ssl-协议"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-ssl-协议-t63-ssl-协议","aria-hidden":"true"}},[this._v("#")]),this._v(" 3. SSL 协议 [#](#t63. SSL 协议)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"http://img.zhufengpeixun.cn/tls_ssl.png",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_3-1-对称加密-t73-1-对称加密"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-对称加密-t73-1-对称加密","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.1 对称加密 [#](#t73.1 对称加密)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("常见的有 AES-CBC、DES、3DES、AES-GCM等，相同的密钥可以用于信息的加密和解密，掌握密钥才能获取信息，能够防止信息窃听，通信方式是1对1；")]),this._v(" "),s("li",[this._v("对称加密需要共享相同的密码，密码的安全是保证信息安全的基础，服务器和多 个客户端通信，需要维持多个密码记录，且缺少修改密码的机制；")]),this._v(" "),s("li",[this._v("优点：算法公开、计算量小、加密速度快、加密效率高。")]),this._v(" "),s("li",[this._v("缺点：交易双方都使用同样钥匙，安全性得不到保证。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"http://img.zhufengpeixun.cn/https2.png",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_3-2-非对称加密技术-t83-2-非对称加密技术"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-非对称加密技术-t83-2-非对称加密技术","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.2 非对称加密技术 [#](#t83.2 非对称加密技术)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("即常见的 RSA 算法，还包括 ECC、DH 等算法，算法特点是，密钥成对出现，一般称为公钥(公开)和私钥(保密)，公钥加密的信息只能私钥解开，私钥加密的信息只能公钥解开。因此掌握公钥的不同客户端之间不能互相解密信息，只能和掌握私钥的服务器进行加密通信，服务器可以实现1对多的通信，客户端也可以用来验证掌握私钥的服务器身份。")]),this._v(" "),s("li",[this._v("非对称加密的特点是信息传输一对多，服务器只需要维持一个私钥就能够和多个客户端进行加密通信，但服务器发出的信息能够被所有的客户端解密，且该算法的计算复杂，加密速度慢。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"http://img.zhufengpeixun.cn/https3.png",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_3-3-完整性验证算法-t93-3-完整性验证算法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-完整性验证算法-t93-3-完整性验证算法","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.3 完整性验证算法 [#](#t93.3 完整性验证算法)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("常见的有 MD5、SHA1、SHA256，该类函数特点是函数单向不可逆、对输入非常敏感、输出长度固定，针对数据的任何修改都会改变散列函数的结果，用于防止信息篡改并验证数据的完整性；")]),this._v(" "),s("li",[this._v("在信息传输过程中，散列函数不能单独实现信息防篡改，因为明文传输，中间人可以修改信息之后重新计算信息摘要，因此需要对传输的信息以及信息摘要进行加密；")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_3-4-工作方式-t103-4-工作方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-工作方式-t103-4-工作方式","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.4 工作方式 [#](#t103.4 工作方式)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("客户端使用非对称加密与服务器进行通信，实现身份验证并协商对称加密使用的密钥")]),this._v(" "),s("li",[this._v("然后对称加密算法采用协商密钥对信息以及信息摘要进行加密通信，不同的节点之间采用的对称密钥不同，从而可以保证信息只能通信双方获取。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_3-5-ssl协议构成-t113-5-ssl协议构成"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-ssl协议构成-t113-5-ssl协议构成","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.5 SSL协议构成 [#](#t113.5 SSL协议构成)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("第一层是记录协议(Record Protocol), 用于定义传输格式。")]),this._v(" "),s("li",[this._v("第二层握手协议(Handshake Protocol),它建立在SSL记录协议之上,用于在实际的数据传输开始前，通讯双方进行身份认证、协商加密算法、交换加密密钥等。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"http://img.zhufengpeixun.cn/ssltlsprotocal.png",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_3-6-https协议改进过程-t123-6-https协议改进过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-https协议改进过程-t123-6-https协议改进过程","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.6 HTTPS协议改进过程 [#](#t123.6 HTTPS协议改进过程)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_3-6-1-针对窃听风险-t133-6-1-针对窃听风险"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-1-针对窃听风险-t133-6-1-针对窃听风险","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.6.1 针对窃听风险 [#](#t133.6.1 针对窃听风险)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("黑客可以嗅探通信内容 "),s("img",{attrs:{src:"http://img.zhufengpeixun.cn/ssltlsprotocal.png",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"http://img.zhufengpeixun.cn/ssltlsprotocal.png",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("客户端、服务器双方都需要维护大量的密钥，维护成本很高；")]),this._v(" "),s("li",[this._v("因每个客户端、服务器的安全级别不同，密钥容易泄露；")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_3-6-2-安全传递密钥-t143-6-2-安全传递密钥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-2-安全传递密钥-t143-6-2-安全传递密钥","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.6.2 安全传递密钥 [#](#t143.6.2 安全传递密钥)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("公钥是公开的，所以针对私钥加密的信息，黑客截获后可以使用公钥进行解密，获取其中的内容；")]),this._v(" "),s("li",[this._v("公钥并不包含服务器的信息，使用非对称加密算法无法确保服务器身份的合法性，存在中间人攻击的风险，服务器发送给客户端的公钥可能在传送过程中被中间人截获并篡改；")]),this._v(" "),s("li",[this._v("使用非对称加密在数据加密解密过程需要消耗一定时间，降低了数据传输效率；")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_3-6-ssl密钥协商的过程如下-t153-6-ssl密钥协商的过程如下"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-ssl密钥协商的过程如下-t153-6-ssl密钥协商的过程如下","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.6 SSL密钥协商的过程如下 [#](#t153.6 SSL密钥协商的过程如下)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_3-6-1-client-hello过程-t163-6-1-client-hello过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-1-client-hello过程-t163-6-1-client-hello过程","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.6.1. client_hello过程 [#](#t163.6.1. client_hello过程)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"http://img.zhufengpeixun.cn/https_ssl.svg",alt:""}})])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[t._v("版本信息: 支持的最高TSL协议版本version，从低到高依次 SSLv2 SSLv3 TLSv1 TLSv1.1 TLSv1.2，当前基本不再使用低于 TLSv1 的版本")]),t._v(" "),e("li",[t._v("加密套件候选列表(cipher suite): 认证算法 Au (身份验证)、密钥交换算法 KeyExchange(密钥协商)、对称加密算法 Enc (信息加密)和信息摘要 Mac(完整性校验);")]),t._v(" "),e("li",[t._v("压缩算法候选列表:支持的压缩算法 compression methods 列表，用于后续的信息压缩传输;")]),t._v(" "),e("li",[t._v("随机数:随机数就是上图里的RNc,用于后续生成协商密钥;")]),t._v(" "),e("li",[t._v("协商数据:支持协议与算法的相关参数以及其它辅助信息等，常见的 SNI 就属于扩展字段，后续单独讨论该字段作用。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_3-6-2-server-hello-过程-t173-6-2-server-hello-过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-2-server-hello-过程-t173-6-2-server-hello-过程","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.6.2. server_hello 过程 [#](#t173.6.2. server_hello 过程)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("服务端返回协商的信息结果，包括选择使用的协议版本version，选择的加密套件 cipher suite，选择的压缩算法 compression method、随机数 RNs等，其中随机数用于后续的密钥协商;")]),this._v(" "),s("li",[this._v("服务器证书链,用于身份校验和密钥交换")]),this._v(" "),s("li",[this._v("通知客户端server-hello结束,请求客户端的证书和密钥")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_3-6-3-证书校验，协商最后通信密钥-t183-6-3-证书校验，协商最后通信密钥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-3-证书校验，协商最后通信密钥-t183-6-3-证书校验，协商最后通信密钥","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.6.3. 证书校验，协商最后通信密钥 [#](#t183.6.3. 证书校验，协商最后通信密钥)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("证书链的可信性 trusted certificate path")]),this._v(" "),s("li",[this._v("证书是否吊销 revocation")]),this._v(" "),s("li",[this._v("有效期 expiry date，证书是否在有效时间范围;")]),this._v(" "),s("li",[this._v("域名 domain，核查证书域名是否与当前的访问域名匹配，匹配规则后续分析; b. 客户端发送客户端证书,公钥服务端验证(过程同客户端验证) c. 客户端hash所有之前的消息,发送hash值和摘要,用客户端的私钥加密发送给服务端,服务端用客户端的公钥解密,验证了服务端获取的客户端的公钥和算法是正确的 d. 客户端生成pms,用服务端的公钥加密后发送给服务端 e. 客户端和服务端同时计算出最终会话密钥(MS)")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_3-6-4-验证协商密钥-t193-6-4-验证协商密钥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-4-验证协商密钥-t193-6-4-验证协商密钥","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.6.4. 验证协商密钥 [#](#t193.6.4. 验证协商密钥)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_3-6-5-https完整建立连接过程-如下图-t203-6-5-https完整建立连接过程-如下图"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-5-https完整建立连接过程-如下图-t203-6-5-https完整建立连接过程-如下图","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.6.5 HTTPS完整建立连接过程,如下图 [#](#t203.6.5 HTTPS完整建立连接过程,如下图)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("首先建立tcp握手连接")]),this._v(" "),s("li",[this._v("进行ssl协议的握手密钥交换(Handshake protocal)")]),this._v(" "),s("li",[this._v("然后通过共同约定的密钥开始通信")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"http://img.zhufengpeixun.cn/https_protocal.png",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_3-7-证书-t213-7-证书"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-证书-t213-7-证书","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.7 证书 [#](#t213.7 证书)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"http://img.zhufengpeixun.cn/zhengshu_brower.png",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_3-7-1-申请和发放证书流程如下-t223-7-1-申请和发放证书流程如下"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-1-申请和发放证书流程如下-t223-7-1-申请和发放证书流程如下","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.7.1 申请和发放证书流程如下 [#](#t223.7.1 申请和发放证书流程如下)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"http://img.zhufengpeixun.cn/zhengshu.png",alt:""}})])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[t._v("服务方 Server 向第三方机构CA提交公钥、组织信息、个人信息(域名)等信息并申请认证;")]),t._v(" "),e("li",[t._v("CA通过线上、线下等多种手段验证申请者提供信息的真实性，如组织是否存在、企业是否合法，是否拥有域名的所有权等;")]),t._v(" "),e("li",[t._v("如信息审核通过，CA会向申请者签发认证文件-证书。证书包含以下信息：申请者公钥、申请者的组织信息和个人信息、签发机构 CA的信息、有效时间、证书序列号等信息的明文，同时包含一个签名; 签名的产生算法：首先，使用散列函数计算公开的明文信息的信息摘要，然后，采用 CA的私钥对信息摘要进行加密，密文即签名;")]),t._v(" "),e("li",[t._v("客户端 Client 向服务器 Server 发出请求时，Server 返回证书文件;")]),t._v(" "),e("li",[t._v("客户端 Client 读取证书中的相关的明文信息，采用相同的散列函数计算得到信息摘要，然后，利用对应 CA的公钥解密签名数据，对比证书的信息摘要，如果一致，则可以确认证书的合法性，即公钥合法;")]),t._v(" "),e("li",[t._v("客户端还会验证证书相关的域名信息、有效时间等信息; 客户端会内置信任CA的证书信息(包含公钥)，如果CA不被信任，则找不到对应 CA的证书，证书也会被判定非法。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_3-7-2-证书链-t233-7-2-证书链"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-2-证书链-t233-7-2-证书链","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.7.2 证书链 [#](#t233.7.2 证书链)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"http://img.zhufengpeixun.cn/zhengshulian.png",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("服务器证书 server.pem 的签发者为中间证书机构 inter，inter 根据证书 inter.pem 验证 server.pem 确实为自己签发的有效证书")]),this._v(" "),s("li",[this._v("中间证书 inter.pem 的签发 CA 为 root，root 根据证书 root.pem 验证 inter.pem 为自己签发的合法证书;")]),this._v(" "),s("li",[this._v("客户端内置信任 CA 的 root.pem 证书，因此服务器证书 server.pem 的被信任。")]),this._v(" "),s("li",[this._v("服务器证书、中间证书与根证书在一起组合成一条合法的证书链，证书链的验证是自下而上的信任传递的过程。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_2-https服务器-t242-https服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-https服务器-t242-https服务器","aria-hidden":"true"}},[this._v("#")]),this._v(" 2. https服务器 [#](#t242. https服务器)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("HTTPS使用https协议，默认端口号443；")]),this._v(" "),s("li",[this._v("HTTPS需要向证书授证中心申请证书；")]),this._v(" "),s("li",[this._v("HTTPS服务器与客户端之间传输是经过SSL安全加密后的密文数据； 在创建HTTPS服务器之前，服务器首先需要创建公钥、私钥及证书，步骤如下 创建公钥、私钥及证书")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_2-1-创建私钥-t252-1-创建私钥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-创建私钥-t252-1-创建私钥","aria-hidden":"true"}},[this._v("#")]),this._v(" 2.1 创建私钥 [#](#t252.1 创建私钥)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("openssl genrsa -out privatekey.pem 1024\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_2-2-创建证书签名请求-t262-2-创建证书签名请求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-创建证书签名请求-t262-2-创建证书签名请求","aria-hidden":"true"}},[this._v("#")]),this._v(" 2.2 创建证书签名请求 [#](#t262.2 创建证书签名请求)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("openssl req -new -key privatekey.pem -out certrequest.csr\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_2-3-获取证书，线上证书需要经过证书授证中心签名的文件；下面只创建一个学习使用证书-t272-3-获取证书，线上证书需要经过证书授证中心签名的文件；下面只创建一个学习使用证书"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-获取证书，线上证书需要经过证书授证中心签名的文件；下面只创建一个学习使用证书-t272-3-获取证书，线上证书需要经过证书授证中心签名的文件；下面只创建一个学习使用证书","aria-hidden":"true"}},[this._v("#")]),this._v(" 2.3 获取证书，线上证书需要经过证书授证中心签名的文件；下面只创建一个学习使用证书 [#](#t272.3 获取证书，线上证书需要经过证书授证中心签名的文件；下面只创建一个学习使用证书)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("openssl x509 -req -in certrequest.csr -signkey privatekey.pem -out certificate.pem\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_2-4-创建pfx文件-t282-4-创建pfx文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-创建pfx文件-t282-4-创建pfx文件","aria-hidden":"true"}},[this._v("#")]),this._v(" 2.4 创建pfx文件 [#](#t282.4 创建pfx文件)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("openssl pkcs12 -export -in certificate.pem -inkey privatekey.pem -out certificate.pfx\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_2-5-创建服务器-t292-5-创建服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-创建服务器-t292-5-创建服务器","aria-hidden":"true"}},[this._v("#")]),this._v(" 2.5 创建服务器 [#](#t292.5 创建服务器)")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("https"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("requestListener"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[e("p",[t._v("pfx 私钥、公钥以及证书")])]),t._v(" "),e("li",[e("p",[t._v("key 私钥")])]),t._v(" "),e("li",[e("p",[t._v("passphrase 为私钥指定密码")])]),t._v(" "),e("li",[e("p",[t._v("cert 公钥")])]),t._v(" "),e("li",[e("p",[t._v("ca 证书，用于指定一组证书，默认属性值为几个著名的证书授权中心,例如VerlSign")])]),t._v(" "),e("li",[e("p",[t._v("crl 指定证书吊销主")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" https "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" fs "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" pk "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'privatekey.pem'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    pc "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'certificate.pem'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" opts "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    key"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pk"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    cert"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pc\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" server "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" https"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("opts"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("table",[e("thead",[e("tr",[e("th",[t._v("属性名")]),t._v(" "),e("th",[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("pff")]),t._v(" "),e("td",[t._v("用于指定从pfx文件读取出的私钥、公钥以及证书（指定该属性后，无需再指定key、cert、ca）")])]),t._v(" "),e("tr",[e("td",[t._v("key")]),t._v(" "),e("td",[t._v("用于指定后缀名为pem的文件，读出私钥")])]),t._v(" "),e("tr",[e("td",[t._v("cert")]),t._v(" "),e("td",[t._v("用于指定后缀名为pem的文件，读出公钥")])]),t._v(" "),e("tr",[e("td",[t._v("ca")]),t._v(" "),e("td",[t._v("用于指定一组证书，默认值为几个著名的证书授证中心")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_2-6-创建https客户端-t302-6-创建https客户端"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-创建https客户端-t302-6-创建https客户端","aria-hidden":"true"}},[this._v("#")]),this._v(" 2.6 创建HTTPS客户端 [#](#t302.6 创建HTTPS客户端)")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" req "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" https"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("callback"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[e("p",[t._v("host 指定域名或目标主机的IP地址")])]),t._v(" "),e("li",[e("p",[t._v("hostname 指定域名或目标主机的IP地址")])]),t._v(" "),e("li",[e("p",[t._v("port 端口号")])]),t._v(" "),e("li",[e("p",[t._v("method 指定请求方法名")])]),t._v(" "),e("li",[e("p",[t._v("path 指下请求路径及查询字符串")])]),t._v(" "),e("li",[e("p",[t._v("headers 客户端请求头对象")])]),t._v(" "),e("li",[e("p",[t._v("auth 指定认证信息部分")])]),t._v(" "),e("li",[e("p",[t._v("agent 指定用户代理,指定false则从连接池中挑选一个连接状态为关闭的https.Agent对象")])]),t._v(" "),e("li",[e("p",[t._v("pfx 指定私钥、公钥和证书")])]),t._v(" "),e("li",[e("p",[t._v("key 指定私钥")])]),t._v(" "),e("li",[e("p",[t._v("cert 公钥")])]),t._v(" "),e("li",[e("p",[t._v("ca 一组证书")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" options "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        hostname"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        port"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1443")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        path"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        method"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'post'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        key"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'privatekey.pem'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        cert"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'certificate.pem'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        rejectUnhauthorized"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        agent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 从连接池中指定挑选一个当前连接状态为关闭的https.Agent")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    req "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" https"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 或者")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" options "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        hostname"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        port"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1443")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        path"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        method"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'post'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        key"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'privatekey.pem'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        cert"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'certificate.pem'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        rejectUnhauthorized"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 显示指定https.Agent对象")]),t._v("\noptions"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("agent "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("https"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Agent")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" req "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" https"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_3-8-让你的网站支持https-t313-8-让你的网站支持https"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-让你的网站支持https-t313-8-让你的网站支持https","aria-hidden":"true"}},[this._v("#")]),this._v(" 3.8 让你的网站支持https [#](#t313.8 让你的网站支持https)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[this._v("git")]),this._v(" clone https://github.com/letsencrypt/letsencrypt\n"),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("cd")]),this._v(" letsencrypt\n"),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("chmod")]),this._v(" 777 ./letsencrypt-auto\n./letsencrypt-auto certonly --standalone --email zhang_renyang@126.com -d itnewhand.com\n\n/etc/letsencrypt/live/itnewhand.com/fullchain.pem\n/etc/letsencrypt/live/itnewhand.com/privkey.pem\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("生成证书时要先停掉nginx")])])}],!1,null,null,null);s.default=n.exports}}]);