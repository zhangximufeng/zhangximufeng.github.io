(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{310:function(t,s,a){"use strict";a.r(s);var n=a(2),r=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#通过配置项启动数据库"}},[t._v("通过配置项启动数据库")]),a("ul",[a("li",[a("a",{attrs:{href:"#_2-导入导出数据-t42-导入导出数据"}},[t._v("2\\. 导入导出数据 #")])]),a("li",[a("a",{attrs:{href:"#_3-备份与恢复-t93-备份与恢复"}},[t._v("3\\. 备份与恢复 #")])]),a("li",[a("a",{attrs:{href:"#_4-直接拷贝数据-t124-直接拷贝数据"}},[t._v("4\\. 直接拷贝数据 #")])]),a("li",[a("a",{attrs:{href:"#_5-锁定和解锁数据库-t135-锁定和解锁数据库"}},[t._v("5\\. 锁定和解锁数据库 #")])]),a("li",[a("a",{attrs:{href:"#_6-安全措施-t146-安全措施"}},[t._v("6\\. 安全措施 #")])]),a("li",[a("a",{attrs:{href:"#_7-数据库高级命令-t237-数据库高级命令"}},[t._v("7\\. 数据库高级命令 #")])]),a("li",[a("a",{attrs:{href:"#_8-什么固定集合-t318-什么固定集合"}},[t._v("8\\. 什么固定集合 #")])]),a("li",[a("a",{attrs:{href:"#_9-gridfs-t359-gridfs"}},[t._v("9\\. gridfs #")])])])])])]),a("p"),t._v(" "),a("h1",{attrs:{id:"通过配置项启动数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过配置项启动数据库","aria-hidden":"true"}},[t._v("#")]),t._v(" 通过配置项启动数据库")]),t._v(" "),a("hr"),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("--dbpath")]),t._v(" "),a("td",[t._v("指定数据库文件的目录")])]),t._v(" "),a("tr",[a("td",[t._v("--port")]),t._v(" "),a("td",[t._v("端口 默认是27017 28017")])]),t._v(" "),a("tr",[a("td",[t._v("--fork")]),t._v(" "),a("td",[t._v("以后台守护的方式进行启动")])]),t._v(" "),a("tr",[a("td",[t._v("--logpath")]),t._v(" "),a("td",[t._v("指定日志文件输出路径")])]),t._v(" "),a("tr",[a("td",[t._v("--config")]),t._v(" "),a("td",[t._v("指定一个配置文件")])]),t._v(" "),a("tr",[a("td",[t._v("--auth")]),t._v(" "),a("td",[t._v("以安全方式启动数据库，默认不验证")])])])]),t._v(" "),a("h3",{attrs:{id:"_1-1-mongo-conf-t11-1-mongo-conf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-mongo-conf-t11-1-mongo-conf","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.1 mongo.conf [#](#t11.1 mongo.conf)")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("dbpath"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("E:\\mongo\\data\nlogpath"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("E:\\mongo\\log\nport"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("50000\n")])])]),a("h3",{attrs:{id:"_1-2-启动服务器-t21-2-启动服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-启动服务器-t21-2-启动服务器","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.2 启动服务器 [#](#t21.2 启动服务器)")]),t._v(" "),a("pre",[a("code",[t._v("mongod --config mongo.conf\n")])]),t._v(" "),a("h3",{attrs:{id:"_1-3-启动客户端-t31-3-启动客户端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-启动客户端-t31-3-启动客户端","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.3 启动客户端 [#](#t31.3 启动客户端)")]),t._v(" "),a("pre",[a("code",[t._v("mongo --port 50000\n")])]),t._v(" "),a("h2",{attrs:{id:"_2-导入导出数据-t42-导入导出数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-导入导出数据-t42-导入导出数据","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. 导入导出数据 [#](#t42. 导入导出数据)")]),t._v(" "),a("p",[t._v("这命令是保存成了文件格式")]),t._v(" "),a("ul",[a("li",[t._v("mongoimport 导出数据")]),t._v(" "),a("li",[t._v("mongoexport 导入数据")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("-h [ --host ]")]),t._v(" "),a("td",[t._v("连接的数据库")])]),t._v(" "),a("tr",[a("td",[t._v("--port")]),t._v(" "),a("td",[t._v("端口号")])]),t._v(" "),a("tr",[a("td",[t._v("-u")]),t._v(" "),a("td",[t._v("用户名")])]),t._v(" "),a("tr",[a("td",[t._v("-p")]),t._v(" "),a("td",[t._v("密码")])]),t._v(" "),a("tr",[a("td",[t._v("-d")]),t._v(" "),a("td",[t._v("导出的数据库")])]),t._v(" "),a("tr",[a("td",[t._v("-d")]),t._v(" "),a("td",[t._v("导出的数据库")])]),t._v(" "),a("tr",[a("td",[t._v("-c")]),t._v(" "),a("td",[t._v("指定导出的集合")])]),t._v(" "),a("tr",[a("td",[t._v("-o")]),t._v(" "),a("td",[t._v("导出的文件存储路径")])]),t._v(" "),a("tr",[a("td",[t._v("-q")]),t._v(" "),a("td",[t._v("进行过滤")])])])]),t._v(" "),a("h3",{attrs:{id:"_2-1-准备数据-t52-1-准备数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-准备数据-t52-1-准备数据","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.1 准备数据 [#](#t52.1 准备数据)")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("use school"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" students "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    students"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zxmf'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("students"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("students"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("students"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-2-备份记录-t62-2-备份记录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-备份记录-t62-2-备份记录","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.2 备份记录 [#](#t62.2 备份记录)")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("mongoexport -h 127.0.0.1 --port 50000  -d school -c students -o stu.bak\n")])])]),a("h3",{attrs:{id:"_2-3-删除记录-t72-3-删除记录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-删除记录-t72-3-删除记录","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.3 删除记录 [#](#t72.3 删除记录)")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("students"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("remove"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nWriteResult"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{ "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nRemoved"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" }"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-4-导入记录-t82-4-导入记录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-导入记录-t82-4-导入记录","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.4 导入记录 [#](#t82.4 导入记录)")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("mongoimport --port 50000 --db school --collection students --file\nstu.bak\n")])])]),a("h2",{attrs:{id:"_3-备份与恢复-t93-备份与恢复"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-备份与恢复-t93-备份与恢复","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. 备份与恢复 [#](#t93. 备份与恢复)")]),t._v(" "),a("h3",{attrs:{id:"_3-1-mongodump-t103-1-mongodump"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-mongodump-t103-1-mongodump","aria-hidden":"true"}},[t._v("#")]),t._v(" 3.1 mongodump [#](#t103.1 mongodump)")]),t._v(" "),a("p",[t._v("在Mongodb中我们使用mongodump命令来备份MongoDB数据。该命令可以导出所有数据到指定目录中。")]),t._v(" "),a("blockquote",[a("p",[t._v("mongodump -h dbhost -d dbname -o dbdirectory")]),t._v(" "),a("ul",[a("li",[t._v("-h MongDB所在服务器地址，例如：127.0.0.1，当然也可以指定端口号：127.0.0.1:27017")]),t._v(" "),a("li",[t._v("-d 需要备份的数据库实例，例如：test")]),t._v(" "),a("li",[t._v("-o 备份的数据存放位置")])])]),t._v(" "),a("pre",[a("code",[t._v("mongodump  -d school -o data.dmp\n")])]),t._v(" "),a("h3",{attrs:{id:"_3-2-mongorestore-t113-2-mongorestore"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-mongorestore-t113-2-mongorestore","aria-hidden":"true"}},[t._v("#")]),t._v(" 3.2 mongorestore [#](#t113.2 mongorestore)")]),t._v(" "),a("p",[t._v("mongodb使用 mongorestore 命令来恢复备份的数据。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("--host MongoDB所在服务器地址")])]),t._v(" "),a("li",[a("p",[t._v("--db -d 需要恢复的数据库实例")])]),t._v(" "),a("li",[a("p",[t._v("最后的一个参数，设置备份数据所在位置")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("mongorestore  data.dmp\nmongorestore -d school data.bmp/school\n")])])])])]),t._v(" "),a("blockquote",[a("p",[t._v("Mongodump可以backup整个数据库，而mongoexport要对每个collection进行操作，最主要的区别也是选择的标准是mongoexport输出的JSON比Mongodump的BSON可读性更高，进而可以直接对JSON文件进行操作然后还原数据（BSON转换JSON存在潜在兼容问题）。")])]),t._v(" "),a("h2",{attrs:{id:"_4-直接拷贝数据-t124-直接拷贝数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-直接拷贝数据-t124-直接拷贝数据","aria-hidden":"true"}},[t._v("#")]),t._v(" 4. 直接拷贝数据 [#](#t124. 直接拷贝数据)")]),t._v(" "),a("h2",{attrs:{id:"_5-锁定和解锁数据库-t135-锁定和解锁数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-锁定和解锁数据库-t135-锁定和解锁数据库","aria-hidden":"true"}},[t._v("#")]),t._v(" 5. 锁定和解锁数据库 [#](#t135. 锁定和解锁数据库)")]),t._v(" "),a("p",[t._v("为了数据的完整性和一致性，导出前要先锁定写入，导出后再解锁。")]),t._v(" "),a("div",{staticClass:"language-sql lite extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" admin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nswitched "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" db admin\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("runCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{fsync:"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("lock")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n{\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"info"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"now locked against writes, use db.fsyncUnlock() to unlock"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"seeAlso"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://dochub.mongodb.org/core/fsynccommand"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ok"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n}\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fsyncUnlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n{ "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ok"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"info"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"unlock completed"')]),t._v(" }\n")])])]),a("h2",{attrs:{id:"_6-安全措施-t146-安全措施"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-安全措施-t146-安全措施","aria-hidden":"true"}},[t._v("#")]),t._v(" 6. 安全措施 [#](#t146. 安全措施)")]),t._v(" "),a("ul",[a("li",[t._v("物理隔离")]),t._v(" "),a("li",[t._v("网络隔离")]),t._v(" "),a("li",[t._v("防火墙(IP/IP段/白名单/黑名单)")]),t._v(" "),a("li",[t._v("用户名和密码验证")])]),t._v(" "),a("h3",{attrs:{id:"_6-1-用户管理-t156-1-用户管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-用户管理-t156-1-用户管理","aria-hidden":"true"}},[t._v("#")]),t._v(" 6.1 用户管理 [#](#t156.1 用户管理)")]),t._v(" "),a("h3",{attrs:{id:"_6-1-1-查看角色-t166-1-1-查看角色"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-1-查看角色-t166-1-1-查看角色","aria-hidden":"true"}},[t._v("#")]),t._v(" 6.1.1 查看角色 [#](#t166.1.1 查看角色)")]),t._v(" "),a("pre",[a("code",[t._v("show roles;\n")])]),t._v(" "),a("p",[t._v("内置角色")]),t._v(" "),a("ul",[a("li",[t._v("数据库用户角色：read、readWrite；")]),t._v(" "),a("li",[t._v("数据库管理角色：dbAdmin、dbOwner、userAdmin;")]),t._v(" "),a("li",[t._v("集群管理角色：clusterAdmin、clusterManager、clusterMonitor、hostManage；")]),t._v(" "),a("li",[t._v("备份恢复角色：backup、restore；")]),t._v(" "),a("li",[t._v("所有数据库角色：readAnyDatabase、readWriteAnyDatabase、userAdminAnyDatabase、dbAdminAnyDatabase")]),t._v(" "),a("li",[t._v("超级用户角色：root")]),t._v(" "),a("li",[t._v("内部角色：__system")])]),t._v(" "),a("h3",{attrs:{id:"_6-1-2-老的创建用户的方法-t176-1-2-老的创建用户的方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-2-老的创建用户的方法-t176-1-2-老的创建用户的方法","aria-hidden":"true"}},[t._v("#")]),t._v(" 6.1.2 老的创建用户的方法 [#](#t176.1.2 老的创建用户的方法)")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("addUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zxmf'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'123456'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nWARNING: The "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'addUser'")]),t._v(" shell helper "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("is")]),t._v(" DEPRECATED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Please "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'createUser'")]),t._v(" inste\nad\nSuccessfully added "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),t._v(": { "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"user"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zxmf"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"roles"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" }\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("show")]),t._v(" roles"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"_6-1-3-新的创建用户的方法-t186-1-3-新的创建用户的方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-3-新的创建用户的方法-t186-1-3-新的创建用户的方法","aria-hidden":"true"}},[t._v("#")]),t._v(" 6.1.3 新的创建用户的方法 [#](#t186.1.3 新的创建用户的方法)")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createUser")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zxmf2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    pwd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"123456"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    roles"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            role"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"readWrite"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"school"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'read'")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("createUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zxmf2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("pwd:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'123456'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("roles:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("{role:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'read'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("db:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'school'")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nSuccessfully added "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),t._v(": {\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"user"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zxmf2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"roles"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                {\n                        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"role"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"read"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"db"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"school"')]),t._v("\n                }\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n}\n")])])]),a("h3",{attrs:{id:"_6-1-4-查看用户的权限-t196-1-4-查看用户的权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-4-查看用户的权限-t196-1-4-查看用户的权限","aria-hidden":"true"}},[t._v("#")]),t._v(" 6.1.4 查看用户的权限 [#](#t196.1.4 查看用户的权限)")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("runCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{usersInfo:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zxmf2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("showPrivileges:"),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n{\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"users"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                {\n                        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_id"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"admin.zxmf2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"user"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zxmf2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"db"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"admin"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"roles"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                                {\n                                        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"role"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"read"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                                        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"db"')]),t._v(" : "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"school"')]),t._v("\n                                }\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n}\n")])])]),a("h3",{attrs:{id:"_6-1-5-服务器启动权限认证-t206-1-5-服务器启动权限认证"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-5-服务器启动权限认证-t206-1-5-服务器启动权限认证","aria-hidden":"true"}},[t._v("#")]),t._v(" 6.1.5 服务器启动权限认证 [#](#t206.1.5 服务器启动权限认证)")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("dbpath"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("E:\\mongo\\data\nlogpath"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("E:\\mongo\\log\nport"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("50000\nauth"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true\n")])])]),a("h3",{attrs:{id:"_6-1-6-用户登录和修改密码-t216-1-6-用户登录和修改密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-6-用户登录和修改密码-t216-1-6-用户登录和修改密码","aria-hidden":"true"}},[t._v("#")]),t._v(" 6.1.6 用户登录和修改密码 [#](#t216.1.6 用户登录和修改密码)")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" admin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" admin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nswitched "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" db admin\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("auth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zxmf'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'123456'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("changeUserPassword"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zxmf'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'123'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("auth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zxmf'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'123'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n")])])]),a("h3",{attrs:{id:"_6-1-7-修改个人信息-t226-1-7-修改个人信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-7-修改个人信息-t226-1-7-修改个人信息","aria-hidden":"true"}},[t._v("#")]),t._v(" 6.1.7 修改个人信息 [#](#t226.1.7 修改个人信息)")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("runCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{updateUser:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zxmf'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("pwd:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'123'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" customData:{\n        name:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'张熙沐枫'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        email:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zxmf@126.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        age:"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n}}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("runCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{usersInfo:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zxmf'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("showPrivileges:"),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[t._v("用户的操作都需要在admin数据库下面进行操作")]),t._v(" "),a("li",[t._v("如果在某个数据库下面执行操作，那么只对当前数据库生效")]),t._v(" "),a("li",[t._v("addUser已经废弃，默认会创建root用户，不安全，不再建议使用")])]),t._v(" "),a("h2",{attrs:{id:"_7-数据库高级命令-t237-数据库高级命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-数据库高级命令-t237-数据库高级命令","aria-hidden":"true"}},[t._v("#")]),t._v(" 7. 数据库高级命令 [#](#t237. 数据库高级命令)")]),t._v(" "),a("h3",{attrs:{id:"_7-1-准备数据-t247-1-准备数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-准备数据-t247-1-准备数据","aria-hidden":"true"}},[t._v("#")]),t._v(" 7.1 准备数据 [#](#t247.1 准备数据)")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" students "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zxmf1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'北京'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zxmf2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'北京'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zxmf3'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'北京'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zxmf4'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'广东'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zxmf5'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'广东'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zxmf6'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'广东'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("students"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("students"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"_7-2-count-t257-2-count"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-count-t257-2-count","aria-hidden":"true"}},[t._v("#")]),t._v(" 7.2 count [#](#t257.2 count)")]),t._v(" "),a("p",[t._v("查看记录数")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("students"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"_7-2-查找不重复的值-distinct-t267-2-查找不重复的值-distinct"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-查找不重复的值-distinct-t267-2-查找不重复的值-distinct","aria-hidden":"true"}},[t._v("#")]),t._v(" 7.2 查找不重复的值 distinct [#](#t267.2 查找不重复的值 distinct)")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("runCommand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("distinct"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'students'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'home'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("values"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"北京"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"广东"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("h3",{attrs:{id:"_7-3-group-分组-t277-3-group-分组"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-group-分组-t277-3-group-分组","aria-hidden":"true"}},[t._v("#")]),t._v(" 7.3 group 分组 [#](#t277.3  group 分组)")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("runCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(":{\n                ns:集合名称，\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("key")]),t._v(":分组的键"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                initial:初始值"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                $reduce:分解器\n                condition:条件"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                finalize:完成时的处理器\n        }\n}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h4",{attrs:{id:"_7-3-1-按城市分组，求每个城市里符合条件的人的年龄总和-t287-3-1-按城市分组，求每个城市里符合条件的人的年龄总和"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-1-按城市分组，求每个城市里符合条件的人的年龄总和-t287-3-1-按城市分组，求每个城市里符合条件的人的年龄总和","aria-hidden":"true"}},[t._v("#")]),t._v(" 7.3.1 按城市分组，求每个城市里符合条件的人的年龄总和 [#](#t287.3.1 按城市分组，求每个城市里符合条件的人的年龄总和)")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("runCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(":{\n                ns:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'students'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("key")]),t._v(":{home:"),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                initial:{total:"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                $reduce:"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("doc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("{\n                      result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("total "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" doc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                }"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                condition:{age:{$gt:"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("}}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                finalize:"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("{\n                    result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'本城市的总年龄为'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("total"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                }\n        }\n}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h4",{attrs:{id:"_7-4-删除集合-t297-4-删除集合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-4-删除集合-t297-4-删除集合","aria-hidden":"true"}},[t._v("#")]),t._v(" 7.4 删除集合 [#](#t297.4 删除集合)")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("runCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("drop")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'students'")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h4",{attrs:{id:"_7-5-runcommand常用命令-t307-5-runcommand常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-5-runcommand常用命令-t307-5-runcommand常用命令","aria-hidden":"true"}},[t._v("#")]),t._v(" 7.5 runCommand常用命令 [#](#t307.5 runCommand常用命令)")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("runCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{buildInfo:"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("runCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{getLastError:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"students"')]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("persons"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{_id:"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("name:"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("persons"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{_id:"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("name:"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("runCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{getLastError:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"students"')]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"_8-什么固定集合-t318-什么固定集合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-什么固定集合-t318-什么固定集合","aria-hidden":"true"}},[t._v("#")]),t._v(" 8. 什么固定集合 [#](#t318. 什么固定集合)")]),t._v(" "),a("p",[t._v("MongoDB 固定集合（Capped Collections）是性能出色且有着固定大小的集合，对于大小固定，我们可以想象其就像一个环形队列，当集合空间用完后，再插入的元素就会覆盖最初始的头部的元素！ "),a("img",{attrs:{src:"assets/firstinfirstout.png",alt:"firstinfirstout"}})]),t._v(" "),a("h3",{attrs:{id:"_8-1-特性-t328-1-特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-特性-t328-1-特性","aria-hidden":"true"}},[t._v("#")]),t._v(" 8.1 特性 [#](#t328.1 特性)")]),t._v(" "),a("ul",[a("li",[a("ol",[a("li",[t._v("没有索引")])])]),t._v(" "),a("li",[a("ol",[a("li",[t._v("插入和查询速度速度非常快 不需要重新分配空间")])])]),t._v(" "),a("li",[a("ol",[a("li",[t._v("特别适合存储日志")])])])]),t._v(" "),a("h3",{attrs:{id:"_8-2-创建固定集合-t338-2-创建固定集合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-创建固定集合-t338-2-创建固定集合","aria-hidden":"true"}},[t._v("#")]),t._v(" 8.2 创建固定集合 [#](#t338.2 创建固定集合)")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("我们通过createCollection来创建一个固定集合，且capped选项设置为true：")])]),t._v(" "),a("li",[a("p",[t._v("还可以指定文档个数,加上max:1000属性：")])]),t._v(" "),a("li",[a("p",[t._v("判断集合是否为固定集合: db.logs.isCapped()")])]),t._v(" "),a("li",[a("p",[t._v("size 是整个集合空间大小，单位为【KB】")])]),t._v(" "),a("li",[a("p",[t._v("max 是集合文档个数上线，单位是【个】")])]),t._v(" "),a("li",[a("p",[t._v("如果空间大小到达上限，则插入下一个文档时，会覆盖第一个文档；如果文档个数到达上限，同样插入下一个文档时，会覆盖第一个文档。两个参数上限判断取的是【与】的逻辑。")])]),t._v(" "),a("li",[a("p",[t._v("capped 封顶的")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("createCollection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'logs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("{size:"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("max:"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("capped:"),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])]),t._v(" "),a("h3",{attrs:{id:"_8-3-非固定集合转为固定集合-t348-3-非固定集合转为固定集合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-3-非固定集合转为固定集合-t348-3-非固定集合转为固定集合","aria-hidden":"true"}},[t._v("#")]),t._v(" 8.3 非固定集合转为固定集合 [#](#t348.3 非固定集合转为固定集合)")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("runCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{convertToCapped:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"logs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("size:"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"_9-gridfs-t359-gridfs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-gridfs-t359-gridfs","aria-hidden":"true"}},[t._v("#")]),t._v(" 9. gridfs [#](#t359. gridfs)")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("gridfs是mongodb自带的文件系统，使用二进制存储文件。")])]),t._v(" "),a("li",[a("p",[t._v("mongodb可以以BSON格式保存二进制对象。")])]),t._v(" "),a("li",[a("p",[t._v("但是BSON对象的体积不能超过4M。所以mongodb提供了"),a("code",[t._v("mongofiles")]),t._v("。它可以把一个大文件透明地分割成小文件（256K），从而保存大体积的数据。")])]),t._v(" "),a("li",[a("p",[t._v("GridFS 用于存储和恢复那些超过16M（BSON文件限制）的文件(如：图片、音频、视频等)。")])]),t._v(" "),a("li",[a("p",[t._v("GridFS 用两个集合来存储一个文件：fs.files与fs.chunks。")])]),t._v(" "),a("li",[a("p",[t._v("每个文件的实际内容被存在chunks(二进制数据)中,和文件有关的meta数据(filename,content_type,还有用户自定义的属性)将会被存在files集合中。")])]),t._v(" "),a("li",[a("h3",{attrs:{id:"_9-1-上传一个文件-t369-1-上传一个文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-上传一个文件-t369-1-上传一个文件","aria-hidden":"true"}},[t._v("#")]),t._v(" 9.1 上传一个文件 [#](#t369.1  上传一个文件)")])]),t._v(" "),a("li",[a("p",[t._v("-d 数据库的名称")])]),t._v(" "),a("li",[a("p",[t._v("-l 源文件的位置")])]),t._v(" "),a("li",[a("p",[t._v("put 指定文件名")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("mongofiles -d myfiles put test.txt\n")])])])])]),t._v(" "),a("h3",{attrs:{id:"_9-2-获取并下载文件-t379-2-获取并下载文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-获取并下载文件-t379-2-获取并下载文件","aria-hidden":"true"}},[t._v("#")]),t._v(" 9.2 获取并下载文件 [#](#t379.2  获取并下载文件)")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("mongofiles -d myfiles  get "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test.txt'")]),t._v("\n")])])]),a("h3",{attrs:{id:"_9-3-查看所有文件-t389-3-查看所有文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-3-查看所有文件-t389-3-查看所有文件","aria-hidden":"true"}},[t._v("#")]),t._v(" 9.3 查看所有文件 [#](#t389.3  查看所有文件)")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("mongofiles "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d myfiles  list\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("files"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("chunks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{files_id:ObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"_9-4-删除文件-t399-4-删除文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-4-删除文件-t399-4-删除文件","aria-hidden":"true"}},[t._v("#")]),t._v(" 9.4 删除文件 [#](#t399.4  删除文件)")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("mongofiles -d myfiles delete "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test.txt"')]),t._v("\n")])])]),a("h3",{attrs:{id:"_9-5-eval-服务器端脚本-t409-5-eval-服务器端脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-5-eval-服务器端脚本-t409-5-eval-服务器端脚本","aria-hidden":"true"}},[t._v("#")]),t._v(" 9.5 eval 服务器端脚本 [#](#t409.5  eval 服务器端脚本)")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("执行JS语句")])]),t._v(" "),a("li",[a("p",[t._v("定义JS全局变量")])]),t._v(" "),a("li",[a("p",[t._v("定义函数")])]),t._v(" "),a("li",[a("p",[t._v("Stored JavaScript")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eval"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1+1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eval"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"return 'hello'\"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("system"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{_id:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"x"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("value")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eval"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"return x"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("system"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("{_id:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"say"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("value")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("{"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello'")]),t._v("}}"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eval"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"say()"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])])])}],!1,null,null,null);s.default=r.exports}}]);