<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>什么是WebPack | Myfun&#39;s Blog</title>
    <meta name="description" content="webpack">
    <link rel="icon" href="/favicon.ico">
    <meta name="keywords" content="webpack">
    <link rel="preload" href="/assets/css/0.styles.6bc9bf16.css" as="style"><link rel="preload" href="/assets/js/app.35b69267.js" as="script"><link rel="preload" href="/assets/js/39.fcf34164.js" as="script"><link rel="prefetch" href="/assets/js/10.a2f6c6ac.js"><link rel="prefetch" href="/assets/js/100.24b9a366.js"><link rel="prefetch" href="/assets/js/101.085f0585.js"><link rel="prefetch" href="/assets/js/102.66d5674f.js"><link rel="prefetch" href="/assets/js/103.7f71429c.js"><link rel="prefetch" href="/assets/js/104.13b0f535.js"><link rel="prefetch" href="/assets/js/105.0a093e85.js"><link rel="prefetch" href="/assets/js/106.a4a1db62.js"><link rel="prefetch" href="/assets/js/107.2634aacf.js"><link rel="prefetch" href="/assets/js/108.b393516d.js"><link rel="prefetch" href="/assets/js/109.769b78fb.js"><link rel="prefetch" href="/assets/js/11.fb483cc4.js"><link rel="prefetch" href="/assets/js/12.24a41994.js"><link rel="prefetch" href="/assets/js/13.a4762474.js"><link rel="prefetch" href="/assets/js/14.4a737bc9.js"><link rel="prefetch" href="/assets/js/15.548f4e99.js"><link rel="prefetch" href="/assets/js/16.b0d2654c.js"><link rel="prefetch" href="/assets/js/17.d43ab467.js"><link rel="prefetch" href="/assets/js/18.0c8f5f87.js"><link rel="prefetch" href="/assets/js/19.19ef59f8.js"><link rel="prefetch" href="/assets/js/2.436a35aa.js"><link rel="prefetch" href="/assets/js/20.24296203.js"><link rel="prefetch" href="/assets/js/21.c486888f.js"><link rel="prefetch" href="/assets/js/22.7e2305f9.js"><link rel="prefetch" href="/assets/js/23.e55bab1b.js"><link rel="prefetch" href="/assets/js/24.1468433c.js"><link rel="prefetch" href="/assets/js/25.6d82837f.js"><link rel="prefetch" href="/assets/js/26.3c4b2f18.js"><link rel="prefetch" href="/assets/js/27.21725a4f.js"><link rel="prefetch" href="/assets/js/28.db16c479.js"><link rel="prefetch" href="/assets/js/29.cb9512e5.js"><link rel="prefetch" href="/assets/js/3.5c82c0f7.js"><link rel="prefetch" href="/assets/js/30.a4c25096.js"><link rel="prefetch" href="/assets/js/31.81741530.js"><link rel="prefetch" href="/assets/js/32.da6d2ac6.js"><link rel="prefetch" href="/assets/js/33.f6164ecd.js"><link rel="prefetch" href="/assets/js/34.0344ad22.js"><link rel="prefetch" href="/assets/js/35.07d4c8d3.js"><link rel="prefetch" href="/assets/js/36.2c6adcff.js"><link rel="prefetch" href="/assets/js/37.ceb5e95e.js"><link rel="prefetch" href="/assets/js/38.d39e96e5.js"><link rel="prefetch" href="/assets/js/4.267db630.js"><link rel="prefetch" href="/assets/js/40.bdf31768.js"><link rel="prefetch" href="/assets/js/41.cc61eccd.js"><link rel="prefetch" href="/assets/js/42.042e4349.js"><link rel="prefetch" href="/assets/js/43.b385d348.js"><link rel="prefetch" href="/assets/js/44.7669f3e2.js"><link rel="prefetch" href="/assets/js/45.2fb532f4.js"><link rel="prefetch" href="/assets/js/46.0cc86442.js"><link rel="prefetch" href="/assets/js/47.30448b83.js"><link rel="prefetch" href="/assets/js/48.8893a5ed.js"><link rel="prefetch" href="/assets/js/49.ed7be1ae.js"><link rel="prefetch" href="/assets/js/5.d8a5933e.js"><link rel="prefetch" href="/assets/js/50.e4af394b.js"><link rel="prefetch" href="/assets/js/51.502ca2a7.js"><link rel="prefetch" href="/assets/js/52.f9768ea6.js"><link rel="prefetch" href="/assets/js/53.0c762369.js"><link rel="prefetch" href="/assets/js/54.dad23d00.js"><link rel="prefetch" href="/assets/js/55.4298d6a4.js"><link rel="prefetch" href="/assets/js/56.d8505fa7.js"><link rel="prefetch" href="/assets/js/57.63d197ce.js"><link rel="prefetch" href="/assets/js/58.ae9a3671.js"><link rel="prefetch" href="/assets/js/59.cb04d7cd.js"><link rel="prefetch" href="/assets/js/6.a83fef9a.js"><link rel="prefetch" href="/assets/js/60.0cedb385.js"><link rel="prefetch" href="/assets/js/61.a5c3f820.js"><link rel="prefetch" href="/assets/js/62.fc2d969d.js"><link rel="prefetch" href="/assets/js/63.53f087e3.js"><link rel="prefetch" href="/assets/js/64.9384bc9a.js"><link rel="prefetch" href="/assets/js/65.bb5db767.js"><link rel="prefetch" href="/assets/js/66.86940f42.js"><link rel="prefetch" href="/assets/js/67.37215862.js"><link rel="prefetch" href="/assets/js/68.e0c14875.js"><link rel="prefetch" href="/assets/js/69.276f0d65.js"><link rel="prefetch" href="/assets/js/7.7e7cde5e.js"><link rel="prefetch" href="/assets/js/70.0fb38ae4.js"><link rel="prefetch" href="/assets/js/71.7c824b27.js"><link rel="prefetch" href="/assets/js/72.bc39810c.js"><link rel="prefetch" href="/assets/js/73.9917d9a4.js"><link rel="prefetch" href="/assets/js/74.7912f7da.js"><link rel="prefetch" href="/assets/js/75.c193b7ec.js"><link rel="prefetch" href="/assets/js/76.ecd4e536.js"><link rel="prefetch" href="/assets/js/77.842c5aba.js"><link rel="prefetch" href="/assets/js/78.0a67366d.js"><link rel="prefetch" href="/assets/js/79.324df7d4.js"><link rel="prefetch" href="/assets/js/8.7063c274.js"><link rel="prefetch" href="/assets/js/80.68c6326b.js"><link rel="prefetch" href="/assets/js/81.a7df7b21.js"><link rel="prefetch" href="/assets/js/82.abd9c0c2.js"><link rel="prefetch" href="/assets/js/83.fd0d8457.js"><link rel="prefetch" href="/assets/js/84.148b432c.js"><link rel="prefetch" href="/assets/js/85.32148693.js"><link rel="prefetch" href="/assets/js/86.7dc5fe11.js"><link rel="prefetch" href="/assets/js/87.bd1be392.js"><link rel="prefetch" href="/assets/js/88.2c0b86aa.js"><link rel="prefetch" href="/assets/js/89.3038cc8d.js"><link rel="prefetch" href="/assets/js/9.5cab2997.js"><link rel="prefetch" href="/assets/js/90.fb4057a1.js"><link rel="prefetch" href="/assets/js/91.4aa5adaf.js"><link rel="prefetch" href="/assets/js/92.aea0a62e.js"><link rel="prefetch" href="/assets/js/93.e2d0e9a7.js"><link rel="prefetch" href="/assets/js/94.a9e33a20.js"><link rel="prefetch" href="/assets/js/95.7c55098e.js"><link rel="prefetch" href="/assets/js/96.c8dfe1c0.js"><link rel="prefetch" href="/assets/js/97.35fc7df3.js"><link rel="prefetch" href="/assets/js/98.551b3ede.js"><link rel="prefetch" href="/assets/js/99.a8f5ffc4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6bc9bf16.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="wrap"><div class="theme-container container no-sidebar"><header class="navbar"><div class="nav-header"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" class="logo"> <span class="site-name can-hide">
        Myfun's Blog
      </span></a> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/interview/" class="nav-link">InterviewMap</a></div><div class="nav-item"><a href="https://zhangximufeng.github.io/css_tricks/" target="_blank" rel="noopener noreferrer" class="nav-link">CSS_Tricks</a></div><div class="nav-item"><a href="https://zhangximufeng.github.io/js_tricks/" target="_blank" rel="noopener noreferrer" class="nav-link">JS_Tricks</a></div><div class="nav-item"><a href="/tags/" class="nav-link">Tags</a></div><div class="nav-item"><a href="https://github.com/zhangximufeng" target="_blank" rel="noopener noreferrer" class="nav-link">Github</a></div><div class="nav-item"><a href="https://zhangximufeng.github.io/animate_resume_ts/" target="_blank" rel="noopener noreferrer" class="nav-link">About</a></div> <!----></nav> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/interview/" class="nav-link">InterviewMap</a></div><div class="nav-item"><a href="https://zhangximufeng.github.io/css_tricks/" target="_blank" rel="noopener noreferrer" class="nav-link">CSS_Tricks</a></div><div class="nav-item"><a href="https://zhangximufeng.github.io/js_tricks/" target="_blank" rel="noopener noreferrer" class="nav-link">JS_Tricks</a></div><div class="nav-item"><a href="/tags/" class="nav-link">Tags</a></div><div class="nav-item"><a href="https://github.com/zhangximufeng" target="_blank" rel="noopener noreferrer" class="nav-link">Github</a></div><div class="nav-item"><a href="https://zhangximufeng.github.io/animate_resume_ts/" target="_blank" rel="noopener noreferrer" class="nav-link">About</a></div> <!----></nav> <!----></div> <div class="page-container"><div><div class="page card"><div class="content-header"><!----> <span class="page-timestamp">2018-09-29</span></div> <div class="content"><p></p><div class="table-of-contents"><ul><li><a href="#什么是webpack">什么是WebPack</a><ul><li><a href="#_2-初始化项目-t12-初始化项目">2\. 初始化项目 #</a></li><li><a href="#_3-快速上手-t23-快速上手">3\. 快速上手 #</a></li><li><a href="#_4-配置开发服务器-t94-配置开发服务器">4\. 配置开发服务器 #</a></li><li><a href="#_5-支持加载css文件-t105-支持加载css文件">5\. 支持加载css文件 #</a></li><li><a href="#_6-插件-t166-插件">6\. 插件 #</a></li><li><a href="#_7-支持图片-t187-支持图片">7\. 支持图片 #</a></li><li><a href="#_8-分离css-t268-分离css">8\. 分离CSS #</a></li><li><a href="#_9-编译less-和-sass-t329-编译less-和-sass">9\. 编译less 和 sass #</a></li><li><a href="#_10-处理css3属性前缀-t3510-处理css3属性前缀">10\. 处理CSS3属性前缀 #</a></li><li><a href="#_11-转义es6-es7-jsx-t3611-转义es6-es7-jsx">11\. 转义ES6/ES7/JSX #</a></li><li><a href="#_12-如何调试打包后的代码-t4012-如何调试打包后的代码">12\. 如何调试打包后的代码 #</a></li><li><a href="#_13-打包第三方类库-t4113-打包第三方类库">13.打包第三方类库 #</a></li><li><a href="#_14-watch-t4614-watch">14\. watch #</a></li><li><a href="#_15-添加商标-t4715-添加商标">15\. 添加商标 #</a></li><li><a href="#_16-拷贝静态文件-t4816-拷贝静态文件">16\. 拷贝静态文件 #</a></li><li><a href="#_17-打包前先清空输出目录-t4917-打包前先清空输出目录">17\. 打包前先清空输出目录 #</a></li><li><a href="#_18-服务器代理-t5018-服务器代理">18\. 服务器代理 #</a></li><li><a href="#_19-resolve解析-t5519-resolve解析">19\. resolve解析 #</a></li><li><a href="#_20-noparse-t6220-noparse">20\. noParse #</a></li><li><a href="#_21-defineplugin-t6321-defineplugin">21\. DefinePlugin #</a></li><li><a href="#_22-ignoreplugin-t6422-ignoreplugin">22\. IgnorePlugin #</a></li><li><a href="#_20-区分环境变量-t6520-区分环境变量">20\. 区分环境变量 #</a></li><li><a href="#_21-多入口-t7021-多入口">21\. 多入口 #</a></li></ul></li></ul></div><p></p> <h1 id="什么是webpack"><a href="#什么是webpack" aria-hidden="true" class="header-anchor">#</a> 什么是WebPack</h1> <hr> <p>WebPack可以看做是模块打包机：它做的事情是，分析你的项目结构，找到JavaScript模块以及其它的一些浏览器不能直接运行的拓展语言（Scss，TypeScript等），并将其打包为合适的格式以供浏览器使用。</p> <p><img src="assets/webpack.jpeg" alt="webpack"></p> <p>构建就是把源代码转换成发布到线上的可执行 JavaScrip、CSS、HTML 代码，包括如下内容。</p> <ul><li>代码转换：TypeScript 编译成 JavaScript、SCSS 编译成 CSS 等。</li> <li>文件优化：压缩 JavaScript、CSS、HTML 代码，压缩合并图片等。</li> <li>代码分割：提取多个页面的公共代码、提取首屏不需要执行部分的代码让其异步加载。</li> <li>模块合并：在采用模块化的项目里会有很多个模块和文件，需要构建功能把模块分类合并成一个文件。</li> <li>自动刷新：监听本地源代码的变化，自动重新构建、刷新浏览器。</li> <li>代码校验：在代码被提交到仓库前需要校验代码是否符合规范，以及单元测试是否通过。</li> <li>自动发布：更新完代码后，自动构建出线上发布代码并传输给发布系统。</li></ul> <p>构建其实是工程化、自动化思想在前端开发中的体现，把一系列流程用代码去实现，让代码自动化地执行这一系列复杂的流程。 构建给前端开发注入了更大的活力，解放了我们的生产力。</p> <h2 id="_2-初始化项目-t12-初始化项目"><a href="#_2-初始化项目-t12-初始化项目" aria-hidden="true" class="header-anchor">#</a> 2. 初始化项目 [#](#t12. 初始化项目)</h2> <pre><code>mkdir zhufeng-webpack
cd zhufeng-webpack
npm init -y
</code></pre> <h2 id="_3-快速上手-t23-快速上手"><a href="#_3-快速上手-t23-快速上手" aria-hidden="true" class="header-anchor">#</a> 3. 快速上手 [#](#t23. 快速上手)</h2> <h3 id="_3-1-webpack核心概念-t33-1-webpack核心概念"><a href="#_3-1-webpack核心概念-t33-1-webpack核心概念" aria-hidden="true" class="header-anchor">#</a> 3.1 webpack核心概念 [#](#t33.1 webpack核心概念)</h3> <ul><li>Entry：入口，Webpack 执行构建的第一步将从 Entry 开始，可抽象成输入。</li> <li>Module：模块，在 Webpack 里一切皆模块，一个模块对应着一个文件。Webpack 会从配置的 Entry 开始递归找出所有依赖的模块。</li> <li>Chunk：代码块，一个 Chunk 由多个模块组合而成，用于代码合并与分割。</li> <li>Loader：模块转换器，用于把模块原内容按照需求转换成新内容。</li> <li>Plugin：扩展插件，在 Webpack 构建流程中的特定时机注入扩展逻辑来改变构建结果或做你想要的事情。</li> <li>Output：输出结果，在 Webpack 经过一系列处理并得出最终想要的代码后输出结果。</li></ul> <blockquote><p>Webpack 启动后会从<code>Entry</code>里配置的<code>Module</code>开始递归解析 Entry 依赖的所有 Module。 每找到一个 Module， 就会根据配置的<code>Loader</code>去找出对应的转换规则，对 Module 进行转换后，再解析出当前 Module 依赖的 Module。 这些模块会以 Entry 为单位进行分组，一个 Entry 和其所有依赖的 Module 被分到一个组也就是一个 <code>Chunk</code>。最后 Webpack 会把所有 Chunk 转换成文件输出。 在整个流程中 Webpack 会在恰当的时机执行 Plugin 里定义的逻辑。</p></blockquote> <h3 id="_3-2-配置webpack-t43-2-配置webpack"><a href="#_3-2-配置webpack-t43-2-配置webpack" aria-hidden="true" class="header-anchor">#</a> 3.2 配置webpack [#](#t43.2 配置webpack)</h3> <pre><code>npm install webpack webpack-cli -D
</code></pre> <h4 id="_3-2-1-创建src目录-t53-2-1-创建src目录"><a href="#_3-2-1-创建src目录-t53-2-1-创建src目录" aria-hidden="true" class="header-anchor">#</a> 3.2.1 创建src目录 [#](#t53.2.1 创建src目录)</h4> <pre><code>mkdir src
</code></pre> <h4 id="_3-2-2-创建dist目录-t63-2-2-创建dist目录"><a href="#_3-2-2-创建dist目录-t63-2-2-创建dist目录" aria-hidden="true" class="header-anchor">#</a> 3.2.2 创建dist目录 [#](#t63.2.2 创建dist目录)</h4> <pre><code>mkdir dist
</code></pre> <h4 id="_3-2-3-基本配置文件-t73-2-3-基本配置文件"><a href="#_3-2-3-基本配置文件-t73-2-3-基本配置文件" aria-hidden="true" class="header-anchor">#</a> 3.2.3 基本配置文件 [#](#t73.2.3 基本配置文件)</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
    entry<span class="token punctuation">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token punctuation">:</span><span class="token string">'bundle.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    module<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>创建dist
<ul><li>创建index.html</li></ul></li> <li>配置文件webpack.config.js
<ul><li>entry：配置入口文件的地址</li> <li>output：配置出口文件的地址</li> <li>module：配置模块,主要用来配置不同文件的加载器</li> <li>plugins：配置插件</li> <li>devServer：配置开发服务器</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
    entry<span class="token punctuation">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token punctuation">:</span><span class="token string">'bundle.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    module<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-2-4-创建index-html文件-t83-2-4-创建index-html文件"><a href="#_3-2-4-创建index-html文件-t83-2-4-创建index-html文件" aria-hidden="true" class="header-anchor">#</a> 3.2.4 创建index.html文件 [#](#t83.2.4 创建index.html文件)</h4> <p>在dist目录下创建index.html文件</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>bundle.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="_4-配置开发服务器-t94-配置开发服务器"><a href="#_4-配置开发服务器-t94-配置开发服务器" aria-hidden="true" class="header-anchor">#</a> 4. 配置开发服务器 [#](#t94. 配置开发服务器)</h2> <pre><code>npm i webpack-dev-server –D
</code></pre> <ul><li>contentBase 配置开发服务运行时的文件根目录</li> <li>host：开发服务器监听的主机地址</li> <li>compress 开发服务器是否启动gzip等压缩</li> <li>port：开发服务器监听的端口</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> devServer<span class="token punctuation">:</span><span class="token punctuation">{</span>
   contentBase<span class="token punctuation">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   host<span class="token punctuation">:</span><span class="token string">'localhost'</span><span class="token punctuation">,</span>
   compress<span class="token punctuation">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
   port<span class="token punctuation">:</span><span class="token number">8080</span>
 <span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token string">&quot;scripts&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
 <span class="token string">&quot;build&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;webpack --mode development&quot;</span><span class="token punctuation">,</span>
 <span class="token string">&quot;dev&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;webpack-dev-server --open --mode development &quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_5-支持加载css文件-t105-支持加载css文件"><a href="#_5-支持加载css文件-t105-支持加载css文件" aria-hidden="true" class="header-anchor">#</a> 5. 支持加载css文件 [#](#t105. 支持加载css文件)</h2> <h3 id="_5-1-什么是loader-t115-1-什么是loader"><a href="#_5-1-什么是loader-t115-1-什么是loader" aria-hidden="true" class="header-anchor">#</a> 5.1 什么是Loader [#](#t115.1 什么是Loader)</h3> <p>通过使用不同的Loader，Webpack可以要把不同的文件都转成JS文件,比如CSS、ES6/7、JSX等</p> <ul><li>test：匹配处理文件的扩展名的正则表达式</li> <li>use：loader名称，就是你要使用模块的名称</li> <li>include/exclude:手动指定必须处理的文件夹或屏蔽不需要处理的文件夹</li> <li>query：为loaders提供额外的设置选项</li></ul> <h3 id="_5-2-loader三种写法-t125-2-loader三种写法"><a href="#_5-2-loader三种写法-t125-2-loader三种写法" aria-hidden="true" class="header-anchor">#</a> 5.2 loader三种写法 [#](#t125.2 loader三种写法)</h3> <ul><li><a href="https://www.npmjs.com/package/css-loader" target="_blank" rel="noopener noreferrer">css-loader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.npmjs.com/package/style-loader" target="_blank" rel="noopener noreferrer">style-loader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h4 id="_5-2-1-loader-t135-2-1-loader"><a href="#_5-2-1-loader-t135-2-1-loader" aria-hidden="true" class="header-anchor">#</a> 5.2.1 loader [#](#t135.2.1 loader)</h4> <p>加载CSS文件，CSS文件有可能在node_modules里，比如bootstrap和antd</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                test<span class="token punctuation">:</span> <span class="token regex">/\.css/</span><span class="token punctuation">,</span>
                loader<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span><span class="token string">'css-loader'</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
</code></pre></div><h4 id="_5-2-2-use-t145-2-2-use"><a href="#_5-2-2-use-t145-2-2-use" aria-hidden="true" class="header-anchor">#</a> 5.2.2 use [#](#t145.2.2 use)</h4> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                test<span class="token punctuation">:</span> <span class="token regex">/\.css/</span><span class="token punctuation">,</span>
                use<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span><span class="token string">'css-loader'</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h4 id="_5-2-3-use-loader-t155-2-3-use-loader"><a href="#_5-2-3-use-loader-t155-2-3-use-loader" aria-hidden="true" class="header-anchor">#</a> 5.2.3 use+loader [#](#t155.2.3 use+loader)</h4> <div class="language-js extra-class"><pre class="language-js"><code>    module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                test<span class="token punctuation">:</span> <span class="token regex">/\.css/</span><span class="token punctuation">,</span>
                include<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
                use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
                    loader<span class="token punctuation">:</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
                    options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        insertAt<span class="token punctuation">:</span><span class="token string">'top'</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'css-loader'</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
</code></pre></div><h2 id="_6-插件-t166-插件"><a href="#_6-插件-t166-插件" aria-hidden="true" class="header-anchor">#</a> 6. 插件 [#](#t166. 插件)</h2> <ul><li>在 webpack 的构建流程中，plugin 用于处理更多其他的一些构建任务</li> <li>模块代码转换的工作由 loader 来处理</li> <li>除此之外的其他任何工作都可以交由 plugin 来完成</li></ul> <h3 id="_6-1-自动产出html-t176-1-自动产出html"><a href="#_6-1-自动产出html-t176-1-自动产出html" aria-hidden="true" class="header-anchor">#</a> 6.1 自动产出html [#](#t176.1 自动产出html)</h3> <p>我们希望自动能产出HTML文件，并在里面引入产出后的资源</p> <pre><code>npm i html-webpack-plugin -D
</code></pre> <ul><li>minify 是对html文件进行压缩，removeAttrubuteQuotes是去掉属性的双引号</li> <li>hash 引入产出资源的时候加上查询参数，值为哈希避免缓存</li> <li>template 模版路径</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
         minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            removeAttributeQuotes<span class="token punctuation">:</span><span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        hash<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        template<span class="token punctuation">:</span> <span class="token string">'./src/index.html'</span><span class="token punctuation">,</span>
        filename<span class="token punctuation">:</span><span class="token string">'index.html'</span>
  	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><h2 id="_7-支持图片-t187-支持图片"><a href="#_7-支持图片-t187-支持图片" aria-hidden="true" class="header-anchor">#</a> 7. 支持图片 [#](#t187. 支持图片)</h2> <h3 id="_7-1-手动添加图片-t197-1-手动添加图片"><a href="#_7-1-手动添加图片-t197-1-手动添加图片" aria-hidden="true" class="header-anchor">#</a> 7.1 手动添加图片 [#](#t197.1 手动添加图片)</h3> <pre><code>npm i file-loader url-loader -D
</code></pre> <ul><li><a href="http://npmjs.com/package/file-loader" target="_blank" rel="noopener noreferrer">file-loader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 解决CSS等文件中的引入图片路径问题</li> <li><a href="https://www.npmjs.com/package/url-loader" target="_blank" rel="noopener noreferrer">url-loader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 当图片小于limit的时候会把图片BASE64编码，大于limit参数的时候还是使用file-loader 进行拷贝</li></ul> <h3 id="_7-2-js中引入图片-t207-2-js中引入图片"><a href="#_7-2-js中引入图片-t207-2-js中引入图片" aria-hidden="true" class="header-anchor">#</a> 7.2 JS中引入图片 [#](#t207.2 JS中引入图片)</h3> <h4 id="_7-2-1-js-t217-2-1-js"><a href="#_7-2-1-js-t217-2-1-js" aria-hidden="true" class="header-anchor">#</a> 7.2.1 JS [#](#t217.2.1 JS)</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> logo<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./images/logo.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> img<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span>src<span class="token operator">=</span>logo<span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_7-2-2-webpack-config-js-t227-2-2-webpack-config-js"><a href="#_7-2-2-webpack-config-js-t227-2-2-webpack-config-js" aria-hidden="true" class="header-anchor">#</a> 7.2.2 webpack.config.js [#](#t227.2.2 webpack.config.js)</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  test<span class="token punctuation">:</span><span class="token regex">/\.(jpg|png|bmp|gif|svg|ttf|woff|woff2|eot)/</span><span class="token punctuation">,</span>
    use<span class="token punctuation">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
       loader<span class="token punctuation">:</span><span class="token string">'url-loader'</span><span class="token punctuation">,</span>
       options<span class="token punctuation">:</span><span class="token punctuation">{</span>limit<span class="token punctuation">:</span><span class="token number">4096</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_7-3-在css中引入图片-t237-3-在css中引入图片"><a href="#_7-3-在css中引入图片-t237-3-在css中引入图片" aria-hidden="true" class="header-anchor">#</a> 7.3 在CSS中引入图片 [#](#t237.3 在CSS中引入图片)</h3> <p>还可以在CSS文件中引入图片</p> <h4 id="_7-3-1-css-t247-3-1-css"><a href="#_7-3-1-css-t247-3-1-css" aria-hidden="true" class="header-anchor">#</a> 7.3.1 CSS [#](#t247.3.1 CSS)</h4> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.logo</span><span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span>355px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span>133px<span class="token punctuation">;</span>
    <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url">url(./images/logo.png)</span><span class="token punctuation">;</span>
    <span class="token property">background-size</span><span class="token punctuation">:</span> cover<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_7-3-2-html-t257-3-2-html"><a href="#_7-3-2-html-t257-3-2-html" aria-hidden="true" class="header-anchor">#</a> 7.3.2 HTML [#](#t257.3.2 HTML)</h4> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>logo<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="_8-分离css-t268-分离css"><a href="#_8-分离css-t268-分离css" aria-hidden="true" class="header-anchor">#</a> 8. 分离CSS [#](#t268. 分离CSS)</h2> <p>因为CSS的下载和JS可以并行,当一个HTML文件很大的时候，我们可以把CSS单独提取出来加载</p> <ul><li><a href="https://github.com/webpack-contrib/mini-css-extract-plugin" target="_blank" rel="noopener noreferrer">mini-css-extract-plugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>filename 打包入口文件</li> <li>chunkFilename 用来打包<code>import('module')</code>方法中引入的模块</li></ul> <h3 id="_8-1-安装依赖模块-t278-1-安装依赖模块"><a href="#_8-1-安装依赖模块-t278-1-安装依赖模块" aria-hidden="true" class="header-anchor">#</a> 8.1 安装依赖模块 [#](#t278.1  安装依赖模块)</h3> <pre><code>npm install --save-dev mini-css-extract-plugin
</code></pre> <h3 id="_8-2-配置webpack-config-js-t288-2-配置webpack-config-js"><a href="#_8-2-配置webpack-config-js-t288-2-配置webpack-config-js" aria-hidden="true" class="header-anchor">#</a> 8.2 配置webpack.config.js [#](#t288.2 配置webpack.config.js)</h3> <div class="language-js extra-class"><pre class="language-js"><code>plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
       <span class="token comment">//参数类似于webpackOptions.output</span>
        <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            filename<span class="token punctuation">:</span> <span class="token string">'[name].css'</span><span class="token punctuation">,</span>
            chunkFilename<span class="token punctuation">:</span><span class="token string">'[id].css'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token punctuation">{</span>
                test<span class="token punctuation">:</span> <span class="token regex">/\.css/</span><span class="token punctuation">,</span>
                include<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
                use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
                    loader<span class="token punctuation">:</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader
                <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'css-loader'</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-3-压缩css和js-t298-3-压缩css和js"><a href="#_8-3-压缩css和js-t298-3-压缩css和js" aria-hidden="true" class="header-anchor">#</a> 8.3 压缩CSS和JS [#](#t298.3 压缩CSS和JS)</h3> <ul><li><p><a href="https://github.com/webpack-contrib/uglifyjs-webpack-plugin" target="_blank" rel="noopener noreferrer">uglifyjs-webpack-plugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://github.com/NMFR/optimize-css-assets-webpack-plugin" target="_blank" rel="noopener noreferrer">optimize-css-assets-webpack-plugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <pre><code>npm i uglifyjs-webpack-plugin -D
npm i optimize-css-assets-webpack-plugin -D
</code></pre></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> UglifyJSplugin<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'uglifyjs-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> OptimizeCssAssetsWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'optimize-css-assets-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        minimizer<span class="token punctuation">:</span> <span class="token punctuation">[</span>
         <span class="token keyword">new</span> <span class="token class-name">UglifyJSplugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
               cache<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//启用缓存</span>
               parallel<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">// 使用多进程运行改进编译速度</span>
               sourceMap<span class="token punctuation">:</span><span class="token boolean">true</span><span class="token comment">//生成sourceMap映射文件</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         <span class="token keyword">new</span> <span class="token class-name">OptimizeCssAssetsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-4-css和image存放单独目录-t308-4-css和image存放单独目录"><a href="#_8-4-css和image存放单独目录-t308-4-css和image存放单独目录" aria-hidden="true" class="header-anchor">#</a> 8.4 css和image存放单独目录 [#](#t308.4 css和image存放单独目录)</h3> <ul><li>outputPath 输出路径</li> <li>publicPath指定的是构建后在html里的路径</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token punctuation">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
       publicPath<span class="token punctuation">:</span><span class="token string">'/'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
  test<span class="token punctuation">:</span><span class="token regex">/\.(jpg|jpeg|png|bmp|gif|svg|ttf|woff|woff2|eot)/</span><span class="token punctuation">,</span>
  use<span class="token punctuation">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          loader<span class="token punctuation">:</span><span class="token string">'url-loader'</span><span class="token punctuation">,</span>
          options<span class="token punctuation">:</span><span class="token punctuation">{</span>
              limit<span class="token punctuation">:</span> <span class="token number">4096</span><span class="token punctuation">,</span>
             outputPath<span class="token punctuation">:</span> <span class="token string">'images'</span><span class="token punctuation">,</span>
             publicPath<span class="token punctuation">:</span><span class="token string">'/images'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
           filename<span class="token punctuation">:</span> <span class="token string">'css/[name].css'</span><span class="token punctuation">,</span>
           chunkFilename<span class="token punctuation">:</span><span class="token string">'css/[id].css'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
</code></pre></div><h3 id="_8-5-在html中使用图片-t318-5-在html中使用图片"><a href="#_8-5-在html中使用图片-t318-5-在html中使用图片" aria-hidden="true" class="header-anchor">#</a> 8.5 在HTML中使用图片 [#](#t318.5 在HTML中使用图片)</h3> <pre><code>npm i html-withimg-loader -D
</code></pre> <p>index.html</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./images/logo.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>webpack.config.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
               test<span class="token punctuation">:</span> <span class="token regex">/\.(html|htm)$/</span><span class="token punctuation">,</span>
               use<span class="token punctuation">:</span> <span class="token string">'html-withimg-loader'</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_9-编译less-和-sass-t329-编译less-和-sass"><a href="#_9-编译less-和-sass-t329-编译less-和-sass" aria-hidden="true" class="header-anchor">#</a> 9. 编译less 和 sass [#](#t329. 编译less 和 sass)</h2> <h3 id="_9-1-安装less-t339-1-安装less"><a href="#_9-1-安装less-t339-1-安装less" aria-hidden="true" class="header-anchor">#</a> 9.1 安装less [#](#t339.1 安装less)</h3> <pre><code>npm i less less-loader -D
npm i node-saas sass-loader -D
</code></pre> <h3 id="_9-2-编写样式-t349-2-编写样式"><a href="#_9-2-编写样式-t349-2-编写样式" aria-hidden="true" class="header-anchor">#</a> 9.2 编写样式 [#](#t349.2 编写样式)</h3> <p>less</p> <div class="language-less extra-class"><pre class="language-less"><code><span class="token variable">@color<span class="token punctuation">:</span></span>orange<span class="token punctuation">;</span>
<span class="token selector">.less-container</span><span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span><span class="token variable">@color</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>sass</p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token property"><span class="token variable">$color</span></span><span class="token punctuation">:</span>green<span class="token punctuation">;</span>
<span class="token selector">.sass-container</span><span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span>green<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>webpack.config.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.less/</span><span class="token punctuation">,</span>
        include<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'css-loader'</span><span class="token punctuation">,</span><span class="token string">'less-loader'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.scss/</span><span class="token punctuation">,</span>
        include<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'css-loader'</span><span class="token punctuation">,</span><span class="token string">'sass-loader'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="_10-处理css3属性前缀-t3510-处理css3属性前缀"><a href="#_10-处理css3属性前缀-t3510-处理css3属性前缀" aria-hidden="true" class="header-anchor">#</a> 10. 处理CSS3属性前缀 [#](#t3510. 处理CSS3属性前缀)</h2> <p>为了浏览器的兼容性，有时候我们必须加入-webkit,-ms,-o,-moz这些前缀</p> <ul><li><p>Trident内核：主要代表为IE浏览器, 前缀为-ms</p></li> <li><p>Gecko内核：主要代表为Firefox, 前缀为-moz</p></li> <li><p>Presto内核：主要代表为Opera, 前缀为-o</p></li> <li><p>Webkit内核：产要代表为Chrome和Safari, 前缀为-webkit</p> <pre><code>npm i postcss-loader autoprefixer -D
</code></pre> <p><a href="https://github.com/postcss/postcss-loader" target="_blank" rel="noopener noreferrer">postcss-loader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul> <p>index.css</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">::placeholder</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>postcss.config.js</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
    plugins<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>webpack.config.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
   test<span class="token punctuation">:</span><span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
   use<span class="token punctuation">:</span><span class="token punctuation">[</span>MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span><span class="token string">'css-loader'</span><span class="token punctuation">,</span><span class="token string">'postcss-loader'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
   include<span class="token punctuation">:</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'./src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   exclude<span class="token punctuation">:</span><span class="token regex">/node_modules/</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_11-转义es6-es7-jsx-t3611-转义es6-es7-jsx"><a href="#_11-转义es6-es7-jsx-t3611-转义es6-es7-jsx" aria-hidden="true" class="header-anchor">#</a> 11. 转义ES6/ES7/JSX [#](#t3611. 转义ES6/ES7/JSX)</h2> <p>Babel其实是一个编译JavaScript的平台,可以把ES6/ES7,React的JSX转义为ES5</p> <h3 id="_11-1-安装依赖包-t3711-1-安装依赖包"><a href="#_11-1-安装依赖包-t3711-1-安装依赖包" aria-hidden="true" class="header-anchor">#</a> 11.1 安装依赖包 [#](#t3711.1  安装依赖包)</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i babel-core babel-loader babel-preset-env babel-preset-stage-0 babel-preset-react babel-plugin-transform-decorators-legacy -D
</code></pre></div><h3 id="_11-2-decorator-t3811-2-decorator"><a href="#_11-2-decorator-t3811-2-decorator" aria-hidden="true" class="header-anchor">#</a> 11.2 decorator [#](#t3811.2 decorator)</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//Option+Shift+A</span>
<span class="token keyword">function</span> <span class="token function">readonly</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>key<span class="token punctuation">,</span>discriptor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    discriptor<span class="token punctuation">.</span>writable<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">{</span>
    @readonly <span class="token constant">PI</span><span class="token operator">=</span><span class="token number">3.14</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> p1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p1<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token operator">=</span><span class="token number">3.15</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span>
</code></pre></div><p>jsconfig.json</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;compilerOptions&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;experimentalDecorators&quot;</span><span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_11-3-webpack-config-js-t3911-3-webpack-config-js"><a href="#_11-3-webpack-config-js-t3911-3-webpack-config-js" aria-hidden="true" class="header-anchor">#</a> 11.3 webpack.config.js [#](#t3911.3 webpack.config.js)</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    test<span class="token punctuation">:</span> <span class="token regex">/\.jsx?$/</span><span class="token punctuation">,</span>
    use<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        loader<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
        options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            presets<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;env&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;stage-0&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;react&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            plugins<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">&quot;transform-decorators-legacy&quot;</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    include<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    exclude<span class="token punctuation">:</span><span class="token regex">/node_modules/</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_12-如何调试打包后的代码-t4012-如何调试打包后的代码"><a href="#_12-如何调试打包后的代码-t4012-如何调试打包后的代码" aria-hidden="true" class="header-anchor">#</a> 12. 如何调试打包后的代码 [#](#t4012. 如何调试打包后的代码)</h2> <p>webpack通过配置可以自动给我们<code>source maps</code>文件，<code>map</code>文件是一种对应编译文件和源文件的方法</p> <ul><li><p>source-map 把映射文件生成到单独的文件，最完整最慢</p></li> <li><p>cheap-module-source-map 在一个单独的文件中产生一个不带列映射的Map</p></li> <li><p>eval-source-map 使用eval打包源文件模块,在同一个文件中生成完整sourcemap</p></li> <li><p>cheap-module-eval-source-map sourcemap和打包后的JS同行显示，没有映射列</p> <p>devtool:'eval-source-map'</p></li></ul> <h2 id="_13-打包第三方类库"><a href="#_13-打包第三方类库" aria-hidden="true" class="header-anchor">#</a> 13.打包第三方类库 <a href="#t4113.%E6%89%93%E5%8C%85%E7%AC%AC%E4%B8%89%E6%96%B9%E7%B1%BB%E5%BA%93">#</a></h2> <h3 id="_13-1-直接引入-t4213-1-直接引入"><a href="#_13-1-直接引入-t4213-1-直接引入" aria-hidden="true" class="header-anchor">#</a> 13.1 直接引入 [#](#t4213.1 直接引入)</h3> <pre><code>import _ from 'lodash';
alert(_.join(['a','b','c'],'@'));
</code></pre> <h3 id="_13-2-插件引入-t4313-2-插件引入"><a href="#_13-2-插件引入-t4313-2-插件引入" aria-hidden="true" class="header-anchor">#</a> 13.2 插件引入 [#](#t4313.2 插件引入)</h3> <ul><li><p>_ 函数会自动添加到当前模块的上下文，无需显示声明</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ProvidePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    _<span class="token punctuation">:</span><span class="token string">'lodash'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ul> <blockquote><p>没有全局的<code>$</code>函数，所以导入依赖全局变量的插件依旧会失败</p></blockquote> <h3 id="_13-3-expose-loader-t4413-3-expose-loader"><a href="#_13-3-expose-loader-t4413-3-expose-loader" aria-hidden="true" class="header-anchor">#</a> 13.3 expose-loader [#](#t4413.3 expose-loader)</h3> <p>不需要任何其他的插件配合，只要将下面的代码添加到所有的loader之前</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;expose-loader?libraryName!./file.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    test<span class="token punctuation">:</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;jquery&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    loader<span class="token punctuation">:</span> <span class="token string">&quot;expose-loader?jQuery&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;expose-loader?$!jquery&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_13-4-externals-t4513-4-externals"><a href="#_13-4-externals-t4513-4-externals" aria-hidden="true" class="header-anchor">#</a> 13.4 externals [#](#t4513.4 externals)</h3> <p>如果我们想引用一个库，但是又不想让webpack打包，并且又不影响我们在程序中以CMD、AMD或者window/global全局等方式进行使用，那就可以通过配置externals</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">const</span> jQuery <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;jquery&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">import</span> jQuery <span class="token keyword">from</span> <span class="token string">'jquery'</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>externals<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        jquery<span class="token punctuation">:</span> <span class="token string">'jQuery'</span><span class="token comment">//如果要在浏览器中运行，那么不用添加什么前缀，默认设置就是global</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

</code></pre></div><h2 id="_14-watch-t4614-watch"><a href="#_14-watch-t4614-watch" aria-hidden="true" class="header-anchor">#</a> 14. watch [#](#t4614. watch)</h2> <p>当代码发生修改后可以自动重新编译</p> <div class="language-js extra-class"><pre class="language-js"><code>watch<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
watchOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    ignored<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span> <span class="token comment">//忽略不用监听变更的目录</span>
    poll<span class="token punctuation">:</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token comment">//每秒询问的文件变更的次数</span>
    aggregateTimeout<span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token comment">//防止重复保存频繁重新编译,500毫秒内重复保存不打包</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>webpack定时获取文件的更新时间，并跟上次保存的时间进行比对，不一致就表示发生了变化,poll就用来配置每秒问多少次</li> <li>当检测文件不再发生变化，会先缓存起来，等待一段时间后之后再通知监听者，这个等待时间通过<code>aggregateTimeout</code>配置</li> <li>webpack只会监听entry依赖的文件</li> <li>我们需要尽可能减少需要监听的文件数量和检查频率，当然频率的降低会导致灵敏度下降</li></ul> <h2 id="_15-添加商标-t4715-添加商标"><a href="#_15-添加商标-t4715-添加商标" aria-hidden="true" class="header-anchor">#</a> 15. 添加商标 [#](#t4715. 添加商标)</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>BannerPlugin</span><span class="token punctuation">(</span><span class="token string">'张熙沐枫'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="_16-拷贝静态文件-t4816-拷贝静态文件"><a href="#_16-拷贝静态文件-t4816-拷贝静态文件" aria-hidden="true" class="header-anchor">#</a> 16. 拷贝静态文件 [#](#t4816. 拷贝静态文件)</h2> <p>有时项目中没有引用的文件也需要打包到目标目录</p> <pre><code>npm i copy-webpack-plugin -D
</code></pre> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
  <span class="token keyword">from</span><span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'src/assets'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">//静态资源目录源地址</span>
  to<span class="token punctuation">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'dist/assets'</span><span class="token punctuation">)</span> <span class="token comment">//目标地址，相对于output的path目录</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_17-打包前先清空输出目录-t4917-打包前先清空输出目录"><a href="#_17-打包前先清空输出目录-t4917-打包前先清空输出目录" aria-hidden="true" class="header-anchor">#</a> 17. 打包前先清空输出目录 [#](#t4917. 打包前先清空输出目录)</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i  clean-webpack-plugin -D
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_18-服务器代理-t5018-服务器代理"><a href="#_18-服务器代理-t5018-服务器代理" aria-hidden="true" class="header-anchor">#</a> 18. 服务器代理 [#](#t5018. 服务器代理)</h2> <p>如果你有单独的后端开发服务器 API，并且希望在同域名下发送 API 请求 ，那么代理某些 URL 会很有用。</p> <h3 id="_18-1-不修改路径-t5118-1-不修改路径"><a href="#_18-1-不修改路径-t5118-1-不修改路径" aria-hidden="true" class="header-anchor">#</a> 18.1 不修改路径 [#](#t5118.1 不修改路径)</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//请求到 /api/users 现在会被代理到请求 http://localhost:3000/api/users。</span>
proxy<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;/api&quot;</span><span class="token punctuation">:</span> <span class="token string">'http://localhost:3000'</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_18-2-修改路径-t5218-2-修改路径"><a href="#_18-2-修改路径-t5218-2-修改路径" aria-hidden="true" class="header-anchor">#</a> 18.2 修改路径 [#](#t5218.2 修改路径)</h3> <div class="language-js extra-class"><pre class="language-js"><code>proxy<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;/api&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
       target<span class="token punctuation">:</span> <span class="token string">'http://localhost:3000'</span><span class="token punctuation">,</span>
       pathRewrite<span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token string">&quot;^/api&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_18-3-before-after-t5318-3-before-after"><a href="#_18-3-before-after-t5318-3-before-after" aria-hidden="true" class="header-anchor">#</a> 18.3 before after [#](#t5318.3 before after)</h3> <p>before 在 webpack-dev-server 静态资源中间件处理之前，可以用于拦截部分请求返回特定内容，或者实现简单的数据 mock。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">before</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">{</span>
  app<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/api/users'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>id<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>name<span class="token punctuation">:</span><span class="token string">'zxmf1'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_18-4-webpack-dev-middleware-t5418-4-webpack-dev-middleware"><a href="#_18-4-webpack-dev-middleware-t5418-4-webpack-dev-middleware" aria-hidden="true" class="header-anchor">#</a> 18.4 webpack-dev-middleware [#](#t5418.4 webpack-dev-middleware)</h3> <p>webpack-dev-middleware 就是在 Express 中提供 webpack-dev-server 静态服务能力的一个中间件</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> webpack-dev-middleware --save-dev
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app<span class="token operator">=</span><span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpackDevMiddleware<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-dev-middleware'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpackOptions<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.config'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
webpackOptions<span class="token punctuation">.</span>mode<span class="token operator">=</span><span class="token string">'development'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> compiler<span class="token operator">=</span><span class="token function">webpack</span><span class="token punctuation">(</span>webpackOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">webpackDevMiddleware</span><span class="token punctuation">(</span>compiler<span class="token punctuation">,</span><span class="token punctuation">{</span>
    <span class="token comment">// webpack-dev-middleware 的配置选项</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>webpack-dev-server 的好处是相对简单，直接安装依赖后执行命令即可</li> <li>而使用<code>webpack-dev-middleware</code>的好处是可以在既有的 Express 代码基础上快速添加 webpack-dev-server 的功能，同时利用 Express 来根据需要添加更多的功能，如 mock 服务、代理 API 请求等</li></ul> <h2 id="_19-resolve解析-t5519-resolve解析"><a href="#_19-resolve解析-t5519-resolve解析" aria-hidden="true" class="header-anchor">#</a> 19. resolve解析 [#](#t5519. resolve解析)</h2> <h3 id="_19-1-extensions-t5619-1-extensions"><a href="#_19-1-extensions-t5619-1-extensions" aria-hidden="true" class="header-anchor">#</a> 19.1 extensions [#](#t5619.1 extensions)</h3> <p>指定extension之后可以不用在<code>require</code>或是<code>import</code>的时候加文件扩展名,会依次尝试添加扩展名进行匹配</p> <div class="language-js extra-class"><pre class="language-js"><code>resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;.js&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;.jsx&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;.json&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;.css&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="_19-2-alias-t5719-2-alias"><a href="#_19-2-alias-t5719-2-alias" aria-hidden="true" class="header-anchor">#</a> 19.2 alias [#](#t5719.2 alias)</h3> <p>配置别名可以加快webpack查找模块的速度</p> <ul><li><p>每当引入bootstrap模块的时候，它会直接引入<code>bootstrap</code>,而不需要从<code>node_modules</code>文件夹中按模块的查找规则查找</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> bootstrap <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'node_modules/_bootstrap@3.3.7@bootstrap/dist/css/bootstrap.css'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    alias<span class="token punctuation">:</span><span class="token punctuation">{</span>
    <span class="token string">&quot;bootstrap&quot;</span><span class="token punctuation">:</span>bootstrap
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div></li></ul> <h3 id="_19-3-modules-t5819-3-modules"><a href="#_19-3-modules-t5819-3-modules" aria-hidden="true" class="header-anchor">#</a> 19.3 modules [#](#t5819.3 modules)</h3> <ul><li><p>对于直接声明依赖名的模块（如 react ），webpack 会类似 Node.js 一样进行路径搜索，搜索 node_modules 目录</p></li> <li><p>这个目录就是使用 resolve.modules 字段进行配置的 默认配置</p> <div class="language-js extra-class"><pre class="language-js"><code>resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
	modules<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'node_modules'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果可以确定项目内所有的第三方依赖模块都是在项目根目录下的 node_modules 中的话</p> <div class="language-js extra-class"><pre class="language-js"><code>resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
	modules<span class="token punctuation">:</span> <span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'node_modules'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <h3 id="_19-4-mainfields-t5919-4-mainfields"><a href="#_19-4-mainfields-t5919-4-mainfields" aria-hidden="true" class="header-anchor">#</a> 19.4 mainFields [#](#t5919.4 mainFields)</h3> <p>默认情况下package.json 文件则按照文件中 main 字段的文件名来查找文件</p> <div class="language-js extra-class"><pre class="language-js"><code>resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// 配置 target === &quot;web&quot; 或者 target === &quot;webworker&quot; 时 mainFields 默认值是：</span>
  mainFields<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'browser'</span><span class="token punctuation">,</span> <span class="token string">'module'</span><span class="token punctuation">,</span> <span class="token string">'main'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// target 的值为其他时，mainFields 默认值为：</span>
  mainFields<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;module&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;main&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_19-5-mainfiles-t6019-5-mainfiles"><a href="#_19-5-mainfiles-t6019-5-mainfiles" aria-hidden="true" class="header-anchor">#</a> 19.5 mainFiles [#](#t6019.5 mainFiles)</h3> <p>当目录下没有 package.json 文件时，我们说会默认使用目录下的 index.js 这个文件，其实这个也是可以配置的</p> <div class="language-js extra-class"><pre class="language-js"><code>resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  mainFiles<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'index'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 你可以添加其他默认使用的文件名</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="_19-6-resolveloader-t6119-6-resolveloader"><a href="#_19-6-resolveloader-t6119-6-resolveloader" aria-hidden="true" class="header-anchor">#</a> 19.6 resolveLoader [#](#t6119.6 resolveLoader)</h3> <p><code>resolve.resolveLoader</code>用于配置解析 loader 时的 resolve 配置,默认的配置：</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  resolveLoader<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    modules<span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">'node_modules'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
    extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.json'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
    mainFields<span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">'loader'</span><span class="token punctuation">,</span> <span class="token string">'main'</span> <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_20-noparse-t6220-noparse"><a href="#_20-noparse-t6220-noparse" aria-hidden="true" class="header-anchor">#</a> 20. noParse [#](#t6220. noParse)</h2> <ul><li><p><code>module.noParse</code> 字段，可以用于配置哪些模块文件的内容不需要进行解析</p></li> <li><p>不需要解析依赖（即无依赖） 的第三方大型类库等，可以通过这个字段来配置，以提高整体的构建速度</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token comment">// ...</span>
module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  noParse<span class="token punctuation">:</span> <span class="token regex">/jquery|lodash/</span><span class="token punctuation">,</span> <span class="token comment">// 正则表达式</span>
  <span class="token comment">// 或者使用函数</span>
  <span class="token function">noParse</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">/</span>jquery<span class="token operator">|</span>lodash<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token operator">...</span>
</code></pre></div><blockquote><p>使用 noParse 进行忽略的模块文件中不能使用 import、require、define 等导入机制</p></blockquote></li></ul> <h2 id="_21-defineplugin-t6321-defineplugin"><a href="#_21-defineplugin-t6321-defineplugin" aria-hidden="true" class="header-anchor">#</a> 21. DefinePlugin [#](#t6321. DefinePlugin)</h2> <p><code>DefinePlugin</code>创建一些在编译时可以配置的全局常量</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token constant">PRODUCTION</span><span class="token punctuation">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token constant">VERSION</span><span class="token punctuation">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
    <span class="token constant">EXPRESSION</span><span class="token punctuation">:</span> <span class="token string">&quot;1+2&quot;</span><span class="token punctuation">,</span>
    <span class="token constant">COPYRIGHT</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token constant">AUTHOR</span><span class="token punctuation">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token string">&quot;张熙沐枫&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">PRODUCTION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">VERSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">EXPRESSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">COPYRIGHT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>如果配置的值是字符串，那么整个字符串会被当成代码片段来执行，其结果作为最终变量的值</li> <li>如果配置的值不是字符串，也不是一个对象字面量，那么该值会被转为一个字符串，如 true，最后的结果是 'true'</li> <li>如果配置的是一个对象字面量，那么该对象的所有 key 会以同样的方式去定义</li> <li>JSON.stringify(true) 的结果是 'true'</li></ul> <h2 id="_22-ignoreplugin-t6422-ignoreplugin"><a href="#_22-ignoreplugin-t6422-ignoreplugin" aria-hidden="true" class="header-anchor">#</a> 22. IgnorePlugin [#](#t6422. IgnorePlugin)</h2> <p>IgnorePlugin用于忽略某些特定的模块，让 webpack 不把这些指定的模块打包进去</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> moment <span class="token keyword">from</span>  <span class="token string">'moment'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>moment<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>IgnorePlugin</span><span class="token punctuation">(</span><span class="token regex">/^\.\/locale/</span><span class="token punctuation">,</span><span class="token regex">/moment$/</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>第一个是匹配引入模块路径的正则表达式</li> <li>第二个是匹配模块的对应上下文，即所在目录名</li></ul> <h2 id="_20-区分环境变量-t6520-区分环境变量"><a href="#_20-区分环境变量-t6520-区分环境变量" aria-hidden="true" class="header-anchor">#</a> 20. 区分环境变量 [#](#t6520. 区分环境变量)</h2> <ul><li>日常的前端开发工作中，一般都会有两套构建环境</li> <li>一套开发时使用，构建结果用于本地开发调试，不进行代码压缩，打印 debug 信息，包含 sourcemap 文件</li> <li>一套构建后的结果是直接应用于线上的，即代码都是压缩后，运行时不打印 debug 信息，静态文件不包括 sourcemap</li> <li>webpack 4.x 版本引入了 mode 的概念</li> <li>当你指定使用 production mode 时，默认会启用各种性能优化的功能，包括构建结果优化以及 webpack 运行性能优化</li> <li>而如果是 development mode 的话，则会开启 debug 工具，运行时打印详细的错误信息，以及更加快速的增量编译构建</li></ul> <h3 id="_20-1-环境差异-t6620-1-环境差异"><a href="#_20-1-环境差异-t6620-1-环境差异" aria-hidden="true" class="header-anchor">#</a> 20.1 环境差异 [#](#t6620.1 环境差异)</h3> <ul><li>生产环境
<ul><li>可能需要分离 CSS 成单独的文件，以便多个页面共享同一个 CSS 文件</li> <li>需要压缩 HTML/CSS/JS 代码</li> <li>需要压缩图片</li></ul></li> <li>开发环境
<ul><li>需要生成 sourcemap 文件</li> <li>需要打印 debug 信息</li> <li>需要 live reload 或者 hot reload 的功能...</li></ul></li></ul> <h3 id="_20-2-获取mode参数-t6720-2-获取mode参数"><a href="#_20-2-获取mode参数-t6720-2-获取mode参数" aria-hidden="true" class="header-anchor">#</a> 20.2 获取mode参数 [#](#t6720.2 获取mode参数)</h3> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span><span class="token operator">=</span><span class="token punctuation">(</span>env<span class="token punctuation">,</span>argv<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        minimizer<span class="token punctuation">:</span> argv<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">'production'</span><span class="token operator">?</span><span class="token punctuation">[</span>
            <span class="token keyword">new</span> <span class="token class-name">UglifyJSplugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  cache<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//启用缓存</span>
                  parallel<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">// 使用多进程运行改进编译速度</span>
                  sourceMap<span class="token punctuation">:</span><span class="token boolean">true</span><span class="token comment">//生成sourceMap映射文件</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">OptimizeCssAssetsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_20-3-封装log方法-t6820-3-封装log方法"><a href="#_20-3-封装log方法-t6820-3-封装log方法" aria-hidden="true" class="header-anchor">#</a> 20.3 封装log方法 [#](#t6820.3 封装log方法)</h3> <ul><li><p>webpack 时传递的 mode 参数，是可以在我们的应用代码运行时，通过 process.env.NODE_ENV 这个变量获取</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">==</span> <span class="token string">'development'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>console<span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <h3 id="_20-4-拆分配置-t6920-4-拆分配置"><a href="#_20-4-拆分配置-t6920-4-拆分配置" aria-hidden="true" class="header-anchor">#</a> 20.4 拆分配置 [#](#t6920.4 拆分配置)</h3> <p>可以把 webpack 的配置按照不同的环境拆分成多个文件，运行时直接根据环境变量加载对应的配置即可</p> <ul><li><p>webpack.base.js：基础部分，即多个文件中共享的配置</p></li> <li><p>webpack.development.js：开发环境使用的配置</p></li> <li><p>webpack.production.js：生产环境使用的配置</p></li> <li><p>webpack.test.js：测试环境使用的配置...</p></li> <li><p><a href="https://github.com/survivejs/webpack-merge" target="_blank" rel="noopener noreferrer">webpack-merge<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> smart <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> base <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.base.js'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">smart</span><span class="token punctuation">(</span>base<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ul> <h2 id="_21-多入口-t7021-多入口"><a href="#_21-多入口-t7021-多入口" aria-hidden="true" class="header-anchor">#</a> 21. 多入口 [#](#t7021. 多入口)</h2> <p>有时候我们的页面可以不止一个HTML页面，会有多个页面，所以就需要多入口</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlWebpackPlugin<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
    entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        index<span class="token punctuation">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
        login<span class="token punctuation">:</span> <span class="token string">'./src/login.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token punctuation">:</span> <span class="token string">'[name].[hash].js'</span><span class="token punctuation">,</span>
        publicPath<span class="token punctuation">:</span> <span class="token string">'/'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                removeAttributeQuotes<span class="token punctuation">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            hash<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            template<span class="token punctuation">:</span> <span class="token string">'./src/index.html'</span><span class="token punctuation">,</span>
            chunks<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'index'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            filename<span class="token punctuation">:</span> <span class="token string">'index.html'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                removeAttributeQuotes<span class="token punctuation">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            hash<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            chunks<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'login'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            template<span class="token punctuation">:</span> <span class="token string">'./src/login.html'</span><span class="token punctuation">,</span>
            filename<span class="token punctuation">:</span> <span class="token string">'login.html'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><a href="https://gitee.com/zhufengpeixun/webpack-start/commits/master" target="_blank" rel="noopener noreferrer">webpack-start<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://webpack.docschina.org/configuration/resolve/" target="_blank" rel="noopener noreferrer">resolve<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <!----> <div class="content page-nav"><p class="inner"><span class="prev">
          ← <a href="/fe/25.koa.html" class="prev">
            koa
          </a></span> <span class="next"><a href="/fe/26.webpack-2-optimize.html">
            libraryTarget 和 library
          </a> →
        </span></p></div> <div id="comment-container"><div class="gt-container"><div class="gt-initing"><i class="gt-loader"></i> <p class="gt-initing-text">Gitalking ...</p></div> <!----> <!----> <div><div class="gt-header"><a class="gt-avatar-github"><span class="gt-ico gt-ico-github"><span class="gt-svg"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M64 524C64 719.602 189.356 885.926 364.113 947.017 387.65799 953 384 936.115 384 924.767L384 847.107C248.118 863.007 242.674 773.052 233.5 758.001 215 726.501 171.5 718.501 184.5 703.501 215.5 687.501 247 707.501 283.5 761.501 309.956 800.642 361.366 794.075 387.658 787.497 393.403 763.997 405.637 743.042 422.353 726.638 281.774 701.609 223 615.67 223 513.5 223 464.053 239.322 418.406 271.465 381.627 251.142 320.928 273.421 269.19 276.337 261.415 334.458 256.131 394.888 302.993 399.549 306.685 432.663 297.835 470.341 293 512.5 293 554.924 293 592.81 297.896 626.075 306.853 637.426 298.219 693.46 258.054 747.5 262.966 750.382 270.652 772.185 321.292 753.058 381.083 785.516 417.956 802 463.809 802 513.5 802 615.874 742.99 701.953 601.803 726.786 625.381 750.003 640 782.295 640 818.008L640 930.653C640.752 939.626 640 948.664978 655.086 948.665 832.344 888.962 960 721.389 960 524 960 276.576 759.424 76 512 76 264.577 76 64 276.576 64 524Z"></path>
</svg>
</span> <!----></span></a> <div class="gt-header-comment"><textarea placeholder="Leave a comment" class="gt-header-textarea"></textarea> <div class="gt-header-preview markdown-body hide"></div> <div class="gt-header-controls"><a href="https://guides.github.com/features/mastering-markdown/" target="_blank" class="gt-header-controls-tip"><span class="gt-ico gt-ico-tip"><span class="gt-svg"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M512 366.949535c-16.065554 0-29.982212 13.405016-29.982212 29.879884l0 359.070251c0 16.167882 13.405016 29.879884 29.982212 29.879884 15.963226 0 29.879884-13.405016 29.879884-29.879884L541.879884 396.829419C541.879884 380.763865 528.474868 366.949535 512 366.949535L512 366.949535z"
    p-id="3083"></path>
  <path d="M482.017788 287.645048c0-7.776956 3.274508-15.553912 8.80024-21.181973 5.525732-5.525732 13.302688-8.80024 21.181973-8.80024 7.776956 0 15.553912 3.274508 21.079644 8.80024 5.525732 5.62806 8.80024 13.405016 8.80024 21.181973 0 7.776956-3.274508 15.656241-8.80024 21.181973-5.525732 5.525732-13.405016 8.697911-21.079644 8.697911-7.879285 0-15.656241-3.274508-21.181973-8.697911C485.292295 303.301289 482.017788 295.524333 482.017788 287.645048L482.017788 287.645048z"
    p-id="3084"></path>
  <path d="M512 946.844409c-239.8577 0-434.895573-195.037873-434.895573-434.895573 0-239.8577 195.037873-434.895573 434.895573-434.895573 239.755371 0 434.895573 195.037873 434.895573 434.895573C946.895573 751.806535 751.755371 946.844409 512 946.844409zM512 126.17088c-212.740682 0-385.880284 173.037274-385.880284 385.777955 0 212.740682 173.037274 385.777955 385.880284 385.777955 212.740682 0 385.777955-173.037274 385.777955-385.777955C897.777955 299.208154 724.740682 126.17088 512 126.17088z"
    p-id="3085"></path>
</svg>
</span> <span class="gt-ico-text">Markdown is supported</span></span></a> <!----> <button class="gt-btn gt-btn-preview"><span class="gt-btn-text">Preview</span> <!----></button> <button class="gt-btn gt-btn-login"><span class="gt-btn-text">Login with GitHub</span> <!----></button></div></div></div> <div class="gt-comments"><span></span> <p class="gt-comments-null">
                Be the first guy leaving a comment!
            </p> <!----></div></div></div></div></div></div> <!----></div> <div class="tool-group"><!----></div></div> <!----></div> <div class="background-mask" style="background:#f6f6f6;"></div></div></div>
    <script src="/assets/js/app.35b69267.js" defer></script><script src="/assets/js/39.fcf34164.js" defer></script>
  </body>
</html>
